<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Linear Mixed Models with Factor Structures • galamm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Linear Mixed Models with Factor Structures">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">galamm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/galamm.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/lmm_factor.html">Linear Mixed Models with Factor Structures</a></li>
    <li><a class="dropdown-item" href="../articles/glmm_factor.html">Generalized Linear Mixed Models with Factor Structures</a></li>
    <li><a class="dropdown-item" href="../articles/lmm_heteroscedastic.html">Heteroscedastic Linear Mixed Models</a></li>
    <li><a class="dropdown-item" href="../articles/latent_observed_interaction.html">Interactions Between Latent and Observed Covariates</a></li>
    <li><a class="dropdown-item" href="../articles/mixed_response.html">Models with Mixed Response Types</a></li>
    <li><a class="dropdown-item" href="../articles/semiparametric.html">Semiparametric Latent Variable Modeling</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced topics</h6></li>
    <li><a class="dropdown-item" href="../articles/scaling.html">Computational Scaling</a></li>
    <li><a class="dropdown-item" href="../articles/optimization.html">Optimization</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/LCBC-UiO/galamm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Linear Mixed Models with Factor Structures</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/LCBC-UiO/galamm/blob/main/vignettes/lmm_factor.Rmd" class="external-link"><code>vignettes/lmm_factor.Rmd</code></a></small>
      <div class="d-none name"><code>lmm_factor.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/LCBC-UiO/galamm" class="external-link">galamm</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">PLmixed</span><span class="op">)</span></span></code></pre></div>
<p>This vignette describes how <code>galamm</code> can be used to
estimate linear mixed models with factor structures. Such models are an
instance of the generalized linear latent and mixed models (GLLAMM)
framework described by <span class="citation">Rabe-Hesketh, Skrondal,
and Pickles (<a href="#ref-rabe-heskethGeneralizedMultilevelStructural2004">2004</a>)</span>
and <span class="citation">Skrondal and Rabe-Hesketh (<a href="#ref-skrondalGeneralizedLatentVariable2004">2004</a>)</span>. The
R package <a href="https://cran.r-project.org/package=PLmixed" class="external-link">PLmixed</a> <span class="citation">(<a href="#ref-rockwoodEstimatingComplexMeasurement2019">Rockwood and Jeon
2019</a>)</span> estimates such models using a profile likelihood
algorithm initially proposed by <span class="citation">Jeon and
Rabe-Hesketh (<a href="#ref-jeonProfileLikelihoodApproachEstimating2012">2012</a>)</span>.
The models are also a special case of generalized additive latent and
mixed models (GALAMM), and in galamm these models are estimated using a
more direct algorithm described in <span class="citation">Sørensen,
Fjell, and Walhovd (<a href="#ref-sorensenLongitudinalModelingAgeDependent2023">2023</a>)</span>.</p>
<p>The examples used in this vignette come from the simulated datasets
provided by <a href="https://cran.r-project.org/package=PLmixed" class="external-link">PLmixed</a> <span class="citation">(<a href="#ref-rockwoodEstimatingComplexMeasurement2019">Rockwood and Jeon
2019</a>)</span>. The purpose of this vignette is to confirm that galamm
gives the same results for these models, and to introduce the syntax. As
will be clear if you run the code, galamm can often be considerably
faster.</p>
<div class="section level3">
<h3 id="crossed-random-effects-model-with-persistence-parameters">Crossed Random Effects Model with Persistence Parameters<a class="anchor" aria-label="anchor" href="#crossed-random-effects-model-with-persistence-parameters"></a>
</h3>
<p>This example comes from Section 3.1 in <span class="citation">Jeon
and Rabe-Hesketh (<a href="#ref-jeonProfileLikelihoodApproachEstimating2012">2012</a>)</span>,
whose model was again based on <span class="citation">McCaffrey et al.
(<a href="#ref-mccaffreyModelsValueAddedModeling2004">2004</a>)</span>.
The dataset <code>KYPSsim</code> comes from <a href="https://cran.r-project.org/package=PLmixed" class="external-link">PLmixed</a> and is a
simulated version of the Korea Youth Panel Survey (KYPS) data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">KYPSsim</span><span class="op">)</span></span>
<span><span class="co">#&gt;   mid hid sid time   esteem</span></span>
<span><span class="co">#&gt; 1   1   1   1    1 2.759234</span></span>
<span><span class="co">#&gt; 2   1   1   1    2 2.980368</span></span>
<span><span class="co">#&gt; 3   1   1   1    3 3.130784</span></span>
<span><span class="co">#&gt; 4   1   1   1    4 3.310306</span></span>
<span><span class="co">#&gt; 5   2   1   2    1 2.924520</span></span>
<span><span class="co">#&gt; 6   2   1   2    2 2.997440</span></span></code></pre></div>
<p>Student self esteem (variable <code>esteem</code>) was assessed at
four timepoints, the first two while the student attended middle school,
and the second two while the student attended high school. The variables
<code>mid</code> and <code>hid</code> represent the middle school and
high school which a given student attended, and <code>sid</code> is the
student identifier. The variable <code>time</code> indicates the given
timepoint.</p>
<p>We will use a discrete time model, and hence convert the time
variable to a factor.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">KYPSsim</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">KYPSsim</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">KYPSsim</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "1" "2" "3" "4"</span></span></code></pre></div>
<p>Since students attending a given middle school not necessarily attend
the same high school, we have a model with crossed random effects. We
use the model of <span class="citation">Jeon and Rabe-Hesketh (<a href="#ref-jeonProfileLikelihoodApproachEstimating2012">2012</a>)</span>,
whose measurement part can be formulated as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>t</mi><mi>s</mi><mi>m</mi><mi>h</mi></mrow></msub><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>t</mi><mi>′</mi><mo>=</mo><mn>2</mn></mrow><mn>4</mn></munderover><msub><mi>d</mi><mrow><mi>t</mi><mi>t</mi><mi>′</mi></mrow></msub><msub><mi>β</mi><mrow><mi>t</mi><mi>′</mi></mrow></msub><mo>+</mo><msubsup><mi>𝐝</mi><mi>t</mi><mi>T</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝛌</mi><mi>m</mi></msub><msub><mi>η</mi><mi>m</mi></msub><mo>+</mo><msub><mi>𝛌</mi><mi>h</mi></msub><msub><mi>η</mi><mi>h</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>η</mi><mi>s</mi></msub><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>t</mi><mi>s</mi><mi>m</mi><mi>h</mi></mrow></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">
y_{tsmh} = \beta_{0} + \sum_{t'=2}^{4} d_{tt'}\beta_{t'} + \mathbf{d}_{t}^{T} \left(\boldsymbol{\lambda}_{m}  \eta_{m} + \boldsymbol{\lambda}_{h}  \eta_{h}\right) + \eta_{s} + \epsilon_{tsmh},
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐝</mi><mi>t</mi></msub><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mrow><mi>t</mi><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>d</mi><mrow><mi>t</mi><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>d</mi><mrow><mi>t</mi><mn>3</mn></mrow></msub><mo>,</mo><msub><mi>d</mi><mrow><mi>t</mi><mn>4</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{d}_{t} = (d_{t1},d_{t2},d_{t3},d_{t4})^{T}</annotation></semantics></math>
is a vector whose
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>th
element equals one and all other elements equal zero.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\beta_{0}</annotation></semantics></math>
is an intercept, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\beta_{2}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>3</mn></msub><annotation encoding="application/x-tex">\beta_{3}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>4</mn></msub><annotation encoding="application/x-tex">\beta_{4}</annotation></semantics></math>
are the effects of timepoints 2, 3, and 4.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>η</mi><mi>m</mi></msub><annotation encoding="application/x-tex">\eta_{m}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>η</mi><mi>h</mi></msub><annotation encoding="application/x-tex">\eta_{h}</annotation></semantics></math>
are the “teacher effects” of middle school
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
and high school
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>,
respectively,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>η</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\eta_{s}</annotation></semantics></math>
is the latent level for student
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϵ</mi><mrow><mi>t</mi><mi>s</mi><mi>m</mi><mi>h</mi></mrow></msub><annotation encoding="application/x-tex">\epsilon_{tsmh}</annotation></semantics></math>
is a residual term.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝛌</mi><mi>m</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\lambda}_{m}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝛌</mi><mi>h</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\lambda}_{h}</annotation></semantics></math>
are factor loadings (called “persistence parameters” by <span class="citation">McCaffrey et al. (<a href="#ref-mccaffreyModelsValueAddedModeling2004">2004</a>)</span> and
<span class="citation">Jeon and Rabe-Hesketh (<a href="#ref-jeonProfileLikelihoodApproachEstimating2012">2012</a>)</span>)
specifying how the teacher effects for middle school and high school
impact the self esteem measurement. Since students attend high school
after middle school, the measurements of self esteem in middle school
are assumed not to be affected by high school, and hence the first two
elements of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝛌</mi><mi>h</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\lambda}_{h}</annotation></semantics></math>
are set to zero. The first nonzero element is set to zero for
identifiability, so we have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝛌</mi><mi>h</mi></msub><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><msub><mi>λ</mi><mrow><mi>h</mi><mn>4</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{\lambda}_{h} = (0, 0, 1, \lambda_{h4})^{T}</annotation></semantics></math>.
Conversely, we allow for middle school to have an effect of measurements
in high school, so
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝛌</mi><mi>m</mi></msub><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><msub><mi>λ</mi><mrow><mi>m</mi><mn>2</mn></mrow></msub><mo>,</mo><msub><mi>λ</mi><mrow><mi>m</mi><mn>3</mn></mrow></msub><mo>,</mo><msub><mi>λ</mi><mrow><mi>m</mi><mn>4</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{\lambda}_{m} = (1, \lambda_{m2}, \lambda_{m3}, \lambda_{m4})^{T}</annotation></semantics></math>,
with the first element set to zero for identifiability. The residuals
are assumed normally distributed,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mrow><mi>t</mi><mi>s</mi><mi>m</mi><mi>h</mi></mrow></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\epsilon_{tsmh} \sim N(0, \phi)</annotation></semantics></math>.</p>
<p>Written out for each of the four timepoints, the model becomes</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>y</mi><mrow><mn>1</mn><mi>s</mi><mi>m</mi><mi>h</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>η</mi><mi>m</mi></msub><mo>+</mo><msub><mi>η</mi><mi>s</mi></msub><mo>+</mo><msub><mi>ϵ</mi><mrow><mn>1</mn><mi>s</mi><mi>m</mi><mi>h</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>y</mi><mrow><mn>2</mn><mi>s</mi><mi>m</mi><mi>h</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mo>+</mo><msub><mi>λ</mi><mrow><mi>m</mi><mn>2</mn></mrow></msub><msub><mi>η</mi><mi>m</mi></msub><mo>+</mo><msub><mi>η</mi><mi>s</mi></msub><mo>+</mo><msub><mi>ϵ</mi><mrow><mn>2</mn><mi>s</mi><mi>m</mi><mi>h</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>y</mi><mrow><mn>3</mn><mi>s</mi><mi>m</mi><mi>h</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><mo>+</mo><msub><mi>λ</mi><mrow><mi>m</mi><mn>3</mn></mrow></msub><msub><mi>η</mi><mi>m</mi></msub><mo>+</mo><msub><mi>η</mi><mi>h</mi></msub><mo>+</mo><msub><mi>η</mi><mi>s</mi></msub><mo>+</mo><msub><mi>ϵ</mi><mrow><mn>3</mn><mi>s</mi><mi>m</mi><mi>h</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>y</mi><mrow><mn>4</mn><mi>s</mi><mi>m</mi><mi>h</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>4</mn></msub><mo>+</mo><msub><mi>λ</mi><mrow><mi>m</mi><mn>4</mn></mrow></msub><msub><mi>η</mi><mi>m</mi></msub><mo>+</mo><msub><mi>λ</mi><mrow><mi>h</mi><mn>4</mn></mrow></msub><msub><mi>η</mi><mi>h</mi></msub><mo>+</mo><msub><mi>η</mi><mi>s</mi></msub><mo>+</mo><msub><mi>ϵ</mi><mrow><mn>4</mn><mi>s</mi><mi>m</mi><mi>h</mi></mrow></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
y_{1smh} &amp;= \beta_{0} +  \eta_{m} + \eta_{s} + \epsilon_{1smh} \\
y_{2smh} &amp;= \beta_{0} + \beta_{2} + \lambda_{m2}  \eta_{m} + \eta_{s} + \epsilon_{2smh} \\
y_{3smh} &amp;= \beta_{0} + \beta_{3} + \lambda_{m3}  \eta_{m} +  \eta_{h} + \eta_{s} + \epsilon_{3smh} \\
y_{4smh} &amp;= \beta_{0} + \beta_{4} + \lambda_{m4}  \eta_{m} + \lambda_{h4}  \eta_{h} + \eta_{s} + \epsilon_{4smh}
\end{aligned}
</annotation></semantics></math></p>
<p>The structural model is simply</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>η</mi><mi>m</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>η</mi><mi>h</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>η</mi><mi>s</mi></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ζ</mi><mi>m</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ζ</mi><mi>h</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ζ</mi><mi>s</mi></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><msub><mi>N</mi><mn>3</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>𝟎</mn><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ψ</mi><mi>m</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ψ</mi><mi>h</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ψ</mi><mi>s</mi></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\begin{pmatrix}
\eta_{m} \\
\eta_{h} \\
\eta_{s}
\end{pmatrix}
=
\begin{pmatrix}
\zeta_{m} \\
\zeta_{h} \\
\zeta_{s}
\end{pmatrix}
\sim
N_{3}\left(\mathbf{0},
\begin{pmatrix}
\psi_{m} &amp; 0 &amp; 0 \\
0 &amp; \psi_{h} &amp; 0 \\
0 &amp; 0 &amp; \psi_{s}
\end{pmatrix}
\right),
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mn>3</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N_{3}(a, b)</annotation></semantics></math>
denotes a trivariate normal distribution with mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
and covariance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>.</p>
<p>In order to fit the model with galamm, we use syntax similar to
PLmixed, and start by defining the loading matrix. The first column
contains
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝛌</mi><mi>m</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\lambda}_{m}</annotation></semantics></math>
and the second column contains
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝛌</mi><mi>h</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\lambda}_{h}</annotation></semantics></math>.
Numerical values in this matrix means that the entry is fixed to the
given value, whereas <code>NA</code> means that the value is unknown,
and should be estimated.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">loading_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    1    0</span></span>
<span><span class="co">#&gt; [2,]   NA    0</span></span>
<span><span class="co">#&gt; [3,]   NA    1</span></span>
<span><span class="co">#&gt; [4,]   NA   NA</span></span></code></pre></div>
<p>We connect the loading matrix to variables in the dataframe with the
following factors.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">factors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ms"</span>, <span class="st">"hs"</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we define the loading variable. This is a variable
connecting rows of the dataframe to rows of the loading matrices. In
this case, for each value of <code>time</code>, the corresponding row of
the loading matrix should be multiplied by the latent variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>η</mi><mi>m</mi></msub><annotation encoding="application/x-tex">\eta_{m}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>η</mi><mi>h</mi></msub><annotation encoding="application/x-tex">\eta_{h}</annotation></semantics></math>,
so we set it as follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">load.var</span> <span class="op">&lt;-</span> <span class="st">"time"</span></span></code></pre></div>
<p>The model formula is specified as</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">form</span> <span class="op">&lt;-</span> <span class="va">esteem</span> <span class="op">~</span> <span class="va">time</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">ms</span> <span class="op">|</span> <span class="va">mid</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">hs</span> <span class="op">|</span> <span class="va">hid</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">sid</span><span class="op">)</span></span></code></pre></div>
<p>We use lme4 syntax for random effects. For example, the term
<code>(0 + ms | mid)</code> corresponds to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mrow><mi>m</mi><mi>t</mi></mrow></msub><msub><mi>η</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_{mt}\eta_{m}</annotation></semantics></math>,
where <code>| mid</code> specifies that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>η</mi><mi>m</mi></msub><annotation encoding="application/x-tex">\eta_{m}</annotation></semantics></math>
should have a unique value for each unique <code>mid</code>. Since
<code>"ms"</code> can be found in the <code>factors</code> defined
above, this term should be treated specially, by making sure that the
latent variable is multiplied by the factor loading corresponding to
<code>"ms"</code> for each particular row. In contrast, the latent
variable for students
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>η</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\eta_{s}</annotation></semantics></math>
is a simple random intercept, and hence the term <code>(1 | sid)</code>
suffices.</p>
<p>We fit the model using <code>galamm</code> with the following
call.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/galamm.html">galamm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">form</span>,</span>
<span>  data <span class="op">=</span> <span class="va">KYPSsim</span>,</span>
<span>  factor <span class="op">=</span> <span class="va">factors</span>,</span>
<span>  load.var <span class="op">=</span> <span class="va">load.var</span>,</span>
<span>  lambda <span class="op">=</span> <span class="va">loading_matrix</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The model could be fit with <code>PLmixed</code> using the following
call, which differs from the call to <code>galamm</code> in that
<code>factor</code> and <code>lambda</code> must be put inside lists.
The reader is encouraged to try, and confirm that the results are
essentially equivalent, but we won’t run it in this vignette as it takes
5-10 minutes.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kyps_plmixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/PLmixed/man/PLmixed.html" class="external-link">PLmixed</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">form</span>,</span>
<span>  data <span class="op">=</span> <span class="va">KYPSsim</span>,</span>
<span>  factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">factors</span><span class="op">)</span>,</span>
<span>  load.var <span class="op">=</span> <span class="va">load.var</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">loading_matrix</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Using galamm’s summary method, we can study the model output.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; GALAMM fit by maximum marginal likelihood.</span></span>
<span><span class="co">#&gt; Formula: form</span></span>
<span><span class="co">#&gt;    Data: KYPSsim</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;  19388.0  19476.2  -9682.0  19364.0    11482 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -3.7952 -0.5945  0.0028  0.6049  3.5753 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Lambda:</span></span>
<span><span class="co">#&gt;              ms     SE    hs    SE</span></span>
<span><span class="co">#&gt; lambda1 1.00000      .     .     .</span></span>
<span><span class="co">#&gt; lambda2 0.87509 0.1421     .     .</span></span>
<span><span class="co">#&gt; lambda3 0.04432 0.1496 1.000     .</span></span>
<span><span class="co">#&gt; lambda4 0.02094 0.1543 1.502 0.504</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">#&gt;  sid      (Intercept) 0.151749 0.38955 </span></span>
<span><span class="co">#&gt;  hid      hs          0.005253 0.07248 </span></span>
<span><span class="co">#&gt;  mid      ms          0.010695 0.10342 </span></span>
<span><span class="co">#&gt;  Residual             0.222511 0.47171 </span></span>
<span><span class="co">#&gt; Number of obs: 11494, groups:  sid, 2924; hid, 860; mid, 104</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value  Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept)   3.1479    0.01524 206.619 0.000e+00</span></span>
<span><span class="co">#&gt; time2         0.1184    0.01253   9.451 3.361e-21</span></span>
<span><span class="co">#&gt; time3         0.1534    0.01607   9.547 1.339e-21</span></span>
<span><span class="co">#&gt; time4         0.1924    0.01675  11.489 1.496e-30</span></span></code></pre></div>
<p>We can look at the factor loadings specifically using the
<code>factor_loadings</code> function. Perhaps not surprisingly, middle
school teacher effects have a low impact on self esteem while the
student attends high school, as can be seen by the last two rows of the
“ms” column being very close to zero.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/factor_loadings.galamm.html">factor_loadings</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 ms        SE       hs        SE</span></span>
<span><span class="co">#&gt; lambda1 1.00000000        NA 0.000000        NA</span></span>
<span><span class="co">#&gt; lambda2 0.87509310 0.1421073 0.000000        NA</span></span>
<span><span class="co">#&gt; lambda3 0.04431740 0.1495679 1.000000        NA</span></span>
<span><span class="co">#&gt; lambda4 0.02093663 0.1542824 1.501574 0.5040217</span></span></code></pre></div>
<p>A diagnostic plot of residuals versus predicted values also looks
acceptable, although there seems to be a slight upward trend.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="lmm_factor_diagnostic_plot-1.png" alt="Diagnostic plot for linear mixed model with factor structures."><div class="figcaption">Diagnostic plot for linear mixed model with
factor structures.</div>
</div>
<p>We can also compare the estimated model to a model with constrained
factor loadings. In particular, we could assume that the teacher effect
in middle school has no effect on self esteem measured during high
school, by setting the last two elements of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝛌</mi><mi>m</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\lambda}_{m}</annotation></semantics></math>
to zero. We would then have the following loading matrix.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">loading_matrix_constr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    1    0</span></span>
<span><span class="co">#&gt; [2,]   NA    0</span></span>
<span><span class="co">#&gt; [3,]    0    1</span></span>
<span><span class="co">#&gt; [4,]    0   NA</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_constr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/galamm.html">galamm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">form</span>,</span>
<span>  data <span class="op">=</span> <span class="va">KYPSsim</span>,</span>
<span>  factor <span class="op">=</span> <span class="va">factors</span>,</span>
<span>  load.var <span class="op">=</span> <span class="va">load.var</span>,</span>
<span>  lambda <span class="op">=</span> <span class="va">loading_matrix_constr1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We could further assume that the factor loadings at timepoints 1 and
2 for middle school and at timepoints 3 and 4 for high schools are
identical, which in practice would lead to a linear mixed model with no
factors. One way of estimating this model is to define a new loading
matrix:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">loading_matrix_constr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    1    0</span></span>
<span><span class="co">#&gt; [2,]    1    0</span></span>
<span><span class="co">#&gt; [3,]    0    1</span></span>
<span><span class="co">#&gt; [4,]    0    1</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_constr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/galamm.html">galamm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">form</span>,</span>
<span>  data <span class="op">=</span> <span class="va">KYPSsim</span>,</span>
<span>  factor <span class="op">=</span> <span class="va">factors</span>,</span>
<span>  load.var <span class="op">=</span> <span class="va">load.var</span>,</span>
<span>  lambda <span class="op">=</span> <span class="va">loading_matrix_constr2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Equivalently, we could create dummy variables for the timepoints:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">KYPSsim</span><span class="op">$</span><span class="va">time12</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">KYPSsim</span><span class="op">$</span><span class="va">time</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">KYPSsim</span><span class="op">$</span><span class="va">time34</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">KYPSsim</span><span class="op">$</span><span class="va">time</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">KYPSsim</span><span class="op">)</span></span>
<span><span class="co">#&gt;   mid hid sid time   esteem time12 time34</span></span>
<span><span class="co">#&gt; 1   1   1   1    1 2.759234      1      0</span></span>
<span><span class="co">#&gt; 2   1   1   1    2 2.980368      1      0</span></span>
<span><span class="co">#&gt; 3   1   1   1    3 3.130784      0      1</span></span>
<span><span class="co">#&gt; 4   1   1   1    4 3.310306      0      1</span></span>
<span><span class="co">#&gt; 5   2   1   2    1 2.924520      1      0</span></span>
<span><span class="co">#&gt; 6   2   1   2    2 2.997440      1      0</span></span></code></pre></div>
<p>We this formulation, we don’t need to specify the
<code>factor</code>, <code>load.var</code>, and <code>lambda</code>
arguments.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_constr2b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/galamm.html">galamm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">esteem</span> <span class="op">~</span> <span class="va">time</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">time12</span> <span class="op">|</span> <span class="va">mid</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">time34</span> <span class="op">|</span> <span class="va">hid</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">sid</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">KYPSsim</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can compare all four models using the <code>anova</code> member
function. Reassuringly, the two ways of formulating the last model give
identical results. Furthermore, this simplest model seems to be
preferred over the two more complex models on this simulated
dataset.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span></span>
<span>  <span class="va">mod</span>, <span class="va">mod_constr1</span>, <span class="va">mod_constr2</span>,</span>
<span>  <span class="va">mod_constr2b</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Data: KYPSsim</span></span>
<span><span class="co">#&gt; Models:</span></span>
<span><span class="co">#&gt; mod_constr2: form</span></span>
<span><span class="co">#&gt; mod_constr2b: esteem ~ time + (0 + time12 | mid) + (0 + time34 | hid) + (1 | sid)</span></span>
<span><span class="co">#&gt; mod_constr1: form</span></span>
<span><span class="co">#&gt; mod: form</span></span>
<span><span class="co">#&gt;              npar   AIC   BIC  logLik deviance   Chisq Df Pr(&gt;Chisq)   </span></span>
<span><span class="co">#&gt; mod_constr2     8 19394 19452 -9688.9    19364                         </span></span>
<span><span class="co">#&gt; mod_constr2b    8 19394 19452 -9688.9    19364  0.0000  0              </span></span>
<span><span class="co">#&gt; mod_constr1    10 19397 19471 -9688.5    19364  0.6661  2   0.716735   </span></span>
<span><span class="co">#&gt; mod            12 19388 19476 -9682.0    19364 13.1070  2   0.001425 **</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multi-trait-multi-rater-model">Multi-Trait Multi-Rater Model<a class="anchor" aria-label="anchor" href="#multi-trait-multi-rater-model"></a>
</h3>
<p>We next consider a model based on example 1 in <span class="citation">Rockwood and Jeon (<a href="#ref-rockwoodEstimatingComplexMeasurement2019">2019</a>)</span>,
which uses the dataset <code>JUDGEsim</code> in <a href="https://cran.r-project.org/package=PLmixed" class="external-link">PLmixed</a>, which is
simulated to mimic the data used by <span class="citation">Koch et al.
(<a href="#ref-kochCrossClassifiedCFAMTMMModel2016">2016</a>)</span>. We
refer to <span class="citation">Rockwood and Jeon (<a href="#ref-rockwoodEstimatingComplexMeasurement2019">2019</a>)</span>
for all the details, and merely present the model and how to estimate it
using <code>galamm</code>. Note however that although the fit with
<code>galamm</code> is identical to that presented in <span class="citation">Rockwood and Jeon (<a href="#ref-rockwoodEstimatingComplexMeasurement2019">2019</a>)</span>,
our estimated factor loadings appear to differ from those in the table
at the bottom of page 298 in <span class="citation">Rockwood and Jeon
(<a href="#ref-rockwoodEstimatingComplexMeasurement2019">2019</a>)</span>,
due to an error in the way the matrix of factor loadings was presented
in <code>PLmixed</code> versions <code>&lt;= 0.1.6</code>. This issue
has been fixed in <code>PLmixed</code> version <code>0.1.7</code>
(Nicholas Rockwood, personal communication, August 2023).</p>
<p>The data contains ratings of two traits in students, and the traits
are rated by both students and teachers.</p>
<p>Initially, we need to convert the item variable to a factor.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">JUDGEsim</span><span class="op">$</span><span class="va">item</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">JUDGEsim</span><span class="op">$</span><span class="va">item</span><span class="op">)</span></span></code></pre></div>
<p>The first ten rows of the dataset are as follows:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">JUDGEsim</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;    item method trait stu class tch response</span></span>
<span><span class="co">#&gt; 1     1      1     1   1     1   1 2.509475</span></span>
<span><span class="co">#&gt; 2     1      1     1   1     1   2 3.246730</span></span>
<span><span class="co">#&gt; 3     1      1     1   1     1   3 2.846695</span></span>
<span><span class="co">#&gt; 4     1      1     1   1     1   4 2.290954</span></span>
<span><span class="co">#&gt; 5     1      1     1   1     1   5 2.794368</span></span>
<span><span class="co">#&gt; 6     1      1     1   1     1   6 2.849511</span></span>
<span><span class="co">#&gt; 7     1      1     1   1     1   7 2.255039</span></span>
<span><span class="co">#&gt; 8     1      1     1   2     1   1 2.676437</span></span>
<span><span class="co">#&gt; 9     1      1     1   2     1   2 2.923184</span></span>
<span><span class="co">#&gt; 10    1      1     1   2     1   3 2.778979</span></span></code></pre></div>
<p>The grouping factors in the data are class (variable
<code>class</code>), student (variable <code>stu</code>) and teacher
(variable <code>tch</code>). The teachers’ ratings of the first trait is
given by items 1-3, and the students’ rating of the same trait is given
by items 7-9. For the second trait, the items are 4-6 and 10-12,
respectively. Looking at the frequency table, we see that there are more
observations of items 1-6. This happens because a single teacher would
in general rate more than one student, whereas a single student would
only rate themselves.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">JUDGEsim</span><span class="op">$</span><span class="va">item</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    1    2    3    4    5    6    7    8    9   10   11   12 </span></span>
<span><span class="co">#&gt; 7828 7828 7828 7828 7828 7828 1249 1249 1249 1249 1249 1249</span></span></code></pre></div>
<p>In matrix-vector format, the measurement model is (equation 16 in
<span class="citation">Rockwood and Jeon (<a href="#ref-rockwoodEstimatingComplexMeasurement2019">2019</a>)</span>)</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>y</mi><mrow><mn>1</mn><mi>t</mi><mi>s</mi><mi>c</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>y</mi><mrow><mn>12</mn><mi>t</mi><mi>s</mi><mi>c</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>β</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>β</mi><mn>12</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>21</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>23</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>31</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>33</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>52</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>54</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>62</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>64</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>85</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>95</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mrow><mn>11</mn><mo>,</mo><mn>6</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mrow><mn>12</mn><mo>,</mo><mn>6</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>η</mi><mrow><mn>1</mn><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>η</mi><mrow><mn>2</mn><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>η</mi><mrow><mn>3</mn><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>η</mi><mrow><mn>4</mn><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>η</mi><mrow><mn>5</mn><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>η</mi><mrow><mn>6</mn><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>η</mi><mrow><mn>7</mn><mi>c</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>𝛜</mi><mrow><mi>t</mi><mi>s</mi><mi>c</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
\begin{pmatrix}
y_{1tsc} \\
\vdots \\
y_{12tsc} \\
\end{pmatrix}
=
\begin{pmatrix}
\beta_{1} \\
\vdots \\
\beta_{12}
\end{pmatrix}
+
\begin{pmatrix}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 1\\
\lambda_{21} &amp; 0 &amp; \lambda_{23} &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\
\lambda_{31} &amp; 0 &amp; \lambda_{33} &amp; 0 &amp; 0 &amp; 0 &amp; 1\\
0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 \\
0 &amp; \lambda_{52} &amp; 0 &amp; \lambda_{54} &amp; 0 &amp; 0 &amp; 1 \\
0 &amp; \lambda_{62} &amp; 0 &amp; \lambda_{64} &amp; 0 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \lambda_{85} &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \lambda_{95} &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \lambda_{11,6} &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \lambda_{12,6} &amp; 1 \\
\end{pmatrix}
\begin{pmatrix}
\eta_{1t}^{(t)} \\
\eta_{2t}^{(t)} \\
\eta_{3s}^{(s)} \\
\eta_{4s}^{(s)} \\
\eta_{5s}^{(s)} \\
\eta_{6s}^{(s)} \\
\eta_{7c}^{(c)} \\
\end{pmatrix} +
\boldsymbol{\epsilon}_{tsc}
</annotation></semantics></math></p>
<p>In brief,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>η</mi><mrow><mn>1</mn><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\eta_{1t}^{(t)}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>η</mi><mrow><mn>2</mn><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\eta_{2t}^{(t)}</annotation></semantics></math>
are the teacher effects,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>η</mi><mrow><mn>3</mn><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\eta_{3s}^{(s)}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>η</mi><mrow><mn>4</mn><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\eta_{4s}^{(s)}</annotation></semantics></math>
are teacher’s perception of the students on the trait,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>η</mi><mrow><mn>5</mn><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\eta_{5s}^{(s)}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>η</mi><mrow><mn>6</mn><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\eta_{6s}^{(s)}</annotation></semantics></math>
are the students’ perception of themselves on the trait, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>η</mi><mrow><mn>7</mn><mi>c</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\eta_{7c}^{(c)}</annotation></semantics></math>
is the classroom effect. The factor loadings are the “regression
coefficients” for regressing the observed items onto these latent
traits. The subscripts
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
indicate teacher, student, and class, respectively.</p>
<p>The structural model is simply</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>η</mi><mrow><mn>1</mn><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>η</mi><mrow><mn>2</mn><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>η</mi><mrow><mn>3</mn><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>η</mi><mrow><mn>4</mn><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>η</mi><mrow><mn>5</mn><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>η</mi><mrow><mn>6</mn><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>η</mi><mrow><mn>7</mn><mi>c</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>ζ</mi><mrow><mn>1</mn><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>ζ</mi><mrow><mn>2</mn><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>ζ</mi><mrow><mn>3</mn><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>ζ</mi><mrow><mn>4</mn><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>ζ</mi><mrow><mn>5</mn><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>ζ</mi><mrow><mn>6</mn><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>ζ</mi><mrow><mn>7</mn><mi>c</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\begin{pmatrix}
\eta_{1t}^{(t)} \\
\eta_{2t}^{(t)} \\
\eta_{3s}^{(s)} \\
\eta_{4s}^{(s)} \\
\eta_{5s}^{(s)} \\
\eta_{6s}^{(s)} \\
\eta_{7c}^{(c)} \\
\end{pmatrix}
=
\begin{pmatrix}
\zeta_{1t}^{(t)} \\
\zeta_{2t}^{(t)} \\
\zeta_{3s}^{(s)} \\
\zeta_{4s}^{(s)} \\
\zeta_{5s}^{(s)} \\
\zeta_{6s}^{(s)} \\
\zeta_{7c}^{(c)} \\
\end{pmatrix}
</annotation></semantics></math></p>
<p>where</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>ζ</mi><mrow><mn>1</mn><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>ζ</mi><mrow><mn>2</mn><mi>t</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><msub><mi>N</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>𝟎</mn><mo>,</mo><msup><mi>𝚿</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\begin{pmatrix}
\zeta_{1t}^{(t)} \\
\zeta_{2t}^{(t)} \\
\end{pmatrix}
\sim N_{2}(\mathbf{0}, \boldsymbol{\Psi}^{(t)}),
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>ζ</mi><mrow><mn>3</mn><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>ζ</mi><mrow><mn>4</mn><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>ζ</mi><mrow><mn>5</mn><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>ζ</mi><mrow><mn>6</mn><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><msub><mi>N</mi><mn>4</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>𝟎</mn><mo>,</mo><msup><mi>𝚿</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\begin{pmatrix}
\zeta_{3s}^{(s)} \\
\zeta_{4s}^{(s)} \\
\zeta_{5s}^{(s)} \\
\zeta_{6s}^{(s)} \\
\end{pmatrix}
\sim N_{4}(\mathbf{0}, \boldsymbol{\Psi}^{(s)}),
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>ζ</mi><mrow><mn>7</mn><mi>c</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><msub><mi>N</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msup><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\begin{pmatrix}
\zeta_{7c}^{(c)} \\
\end{pmatrix}
\sim N_{1}(0, \psi^{(c)}),
</annotation></semantics></math></p>
<p>and</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mrow><mi>t</mi><mi>s</mi><mi>c</mi></mrow></msub><mo>∼</mo><msub><mi>N</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\epsilon_{tsc} \sim N_{1}(0, \phi).
</annotation></semantics></math></p>
<p>We specify the loading matrix as follows. In comparison with the
mathematical model formulation just above, note that we don’t need to
add the last column of only ones, since this column contains no
parameters to be estimated.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">loading_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">0</span>, <span class="cn">NA</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">0</span>, <span class="cn">NA</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span>, <span class="fl">0</span>, <span class="cn">NA</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span>, <span class="fl">0</span>, <span class="cn">NA</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="cn">NA</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="cn">NA</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6]</span></span>
<span><span class="co">#&gt;  [1,]    1    0    1    0    0    0</span></span>
<span><span class="co">#&gt;  [2,]   NA    0   NA    0    0    0</span></span>
<span><span class="co">#&gt;  [3,]   NA    0   NA    0    0    0</span></span>
<span><span class="co">#&gt;  [4,]    0    1    0    1    0    0</span></span>
<span><span class="co">#&gt;  [5,]    0   NA    0   NA    0    0</span></span>
<span><span class="co">#&gt;  [6,]    0   NA    0   NA    0    0</span></span>
<span><span class="co">#&gt;  [7,]    0    0    0    0    1    0</span></span>
<span><span class="co">#&gt;  [8,]    0    0    0    0   NA    0</span></span>
<span><span class="co">#&gt;  [9,]    0    0    0    0   NA    0</span></span>
<span><span class="co">#&gt; [10,]    0    0    0    0    0    1</span></span>
<span><span class="co">#&gt; [11,]    0    0    0    0    0   NA</span></span>
<span><span class="co">#&gt; [12,]    0    0    0    0    0   NA</span></span></code></pre></div>
<p>Next, we specify the factors in the order they appear in the columns
of the loading matrix. We can choose whichever names we like for the
factors, except for names of existing variables in the dataset, but we
must make sure they match the names used in the formula.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">factors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"teacher1"</span>, <span class="st">"teacher2"</span>, <span class="st">"trait1.t"</span>,</span>
<span>  <span class="st">"trait2.t"</span>, <span class="st">"trait1.s"</span>, <span class="st">"trait2.s"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The formula is defined as follows, where have have placed the terms
in the same order as they appear in the mathematical model in
matrix-vector form specified above.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">form</span> <span class="op">&lt;-</span> <span class="va">response</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">item</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">teacher1</span> <span class="op">+</span> <span class="va">teacher2</span> <span class="op">|</span> <span class="va">tch</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">trait1.t</span> <span class="op">+</span> <span class="va">trait2.t</span> <span class="op">+</span> <span class="va">trait1.s</span> <span class="op">+</span> <span class="va">trait2.s</span> <span class="op">|</span> <span class="va">stu</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">class</span><span class="op">)</span></span></code></pre></div>
<p>Using <code>PLmixed</code>, we could have estimated the model as
follows, and doing it would confirm that the results are the same as
with galamm.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">judge_plmixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/PLmixed/man/PLmixed.html" class="external-link">PLmixed</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">form</span>,</span>
<span>  data <span class="op">=</span> <span class="va">JUDGEsim</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">loading_matrix</span><span class="op">)</span>,</span>
<span>  load.var <span class="op">=</span> <span class="st">"item"</span>,</span>
<span>  factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">factors</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We get identical results using <code>galamm</code>, and it takes less
than five minutes.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">judge_galamm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/galamm.html">galamm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">form</span>,</span>
<span>  data <span class="op">=</span> <span class="va">JUDGEsim</span>,</span>
<span>  lambda <span class="op">=</span> <span class="va">loading_matrix</span>,</span>
<span>  load.var <span class="op">=</span> <span class="st">"item"</span>,</span>
<span>  factor <span class="op">=</span> <span class="va">factors</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">judge_galamm</span><span class="op">)</span></span>
<span><span class="co">#&gt; GALAMM fit by maximum marginal likelihood.</span></span>
<span><span class="co">#&gt; Formula: form</span></span>
<span><span class="co">#&gt;    Data: JUDGEsim</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt; 113184.6 113531.9 -56553.3 113106.6    54423 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -3.8407 -0.6439  0.0017  0.6474  3.9799 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Lambda:</span></span>
<span><span class="co">#&gt;          teacher1      SE teacher2      SE trait1.t      SE trait2.t      SE trait1.s      SE trait2.s      SE</span></span>
<span><span class="co">#&gt; lambda1    1.0000       .        .       .    1.000       .        .       .        .       .        .       .</span></span>
<span><span class="co">#&gt; lambda2    1.1278 0.03584        .       .    1.092 0.02172        .       .        .       .        .       .</span></span>
<span><span class="co">#&gt; lambda3    0.9986 0.03345        .       .    1.066 0.02144        .       .        .       .        .       .</span></span>
<span><span class="co">#&gt; lambda4         .       .   1.0000       .        .       .   1.0000       .        .       .        .       .</span></span>
<span><span class="co">#&gt; lambda5         .       .   0.9725 0.03036        .       .   1.0536 0.02576        .       .        .       .</span></span>
<span><span class="co">#&gt; lambda6         .       .   1.2191 0.03436        .       .   0.9581 0.02460        .       .        .       .</span></span>
<span><span class="co">#&gt; lambda7         .       .        .       .        .       .        .       .    1.000       .        .       .</span></span>
<span><span class="co">#&gt; lambda8         .       .        .       .        .       .        .       .    1.322 0.06109        .       .</span></span>
<span><span class="co">#&gt; lambda9         .       .        .       .        .       .        .       .    1.145 0.05633        .       .</span></span>
<span><span class="co">#&gt; lambda10        .       .        .       .        .       .        .       .        .       .    1.000       .</span></span>
<span><span class="co">#&gt; lambda11        .       .        .       .        .       .        .       .        .       .    0.874 0.04417</span></span>
<span><span class="co">#&gt; lambda12        .       .        .       .        .       .        .       .        .       .    1.096 0.04874</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name        Variance Std.Dev. Corr          </span></span>
<span><span class="co">#&gt;  stu      trait1.t    0.24025  0.4902                 </span></span>
<span><span class="co">#&gt;           trait2.t    0.16872  0.4108   0.86          </span></span>
<span><span class="co">#&gt;           trait1.s    0.29588  0.5439   0.46 0.40     </span></span>
<span><span class="co">#&gt;           trait2.s    0.37690  0.6139   0.20 0.30 0.40</span></span>
<span><span class="co">#&gt;  tch      teacher1    0.09704  0.3115                 </span></span>
<span><span class="co">#&gt;           teacher2    0.11321  0.3365   0.44          </span></span>
<span><span class="co">#&gt;  class    (Intercept) 0.00000  0.0000                 </span></span>
<span><span class="co">#&gt;  Residual             0.39044  0.6249                 </span></span>
<span><span class="co">#&gt; Number of obs: 54462, groups:  stu, 1249; tch, 390; class, 125</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;        Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; item1     3.399    0.02270  149.72        0</span></span>
<span><span class="co">#&gt; item2     3.363    0.02502  134.42        0</span></span>
<span><span class="co">#&gt; item3     3.362    0.02329  144.38        0</span></span>
<span><span class="co">#&gt; item4     2.820    0.02226  126.65        0</span></span>
<span><span class="co">#&gt; item5     2.939    0.02225  132.08        0</span></span>
<span><span class="co">#&gt; item6     2.877    0.02512  114.53        0</span></span>
<span><span class="co">#&gt; item7     3.426    0.02344  146.16        0</span></span>
<span><span class="co">#&gt; item8     3.552    0.02696  131.77        0</span></span>
<span><span class="co">#&gt; item9     3.597    0.02496  144.11        0</span></span>
<span><span class="co">#&gt; item10    2.334    0.02479   94.17        0</span></span>
<span><span class="co">#&gt; item11    2.909    0.02330  124.83        0</span></span>
<span><span class="co">#&gt; item12    2.470    0.02599   95.07        0</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-jeonProfileLikelihoodApproachEstimating2012" class="csl-entry">
Jeon, Minjeong, and Sophia Rabe-Hesketh. 2012.
<span>“Profile-<span>Likelihood Approach</span> for <span>Estimating
Generalized Linear Mixed Models With Factor Structures</span>.”</span>
<em>Journal of Educational and Behavioral Statistics</em> 37 (4):
518–42. <a href="https://doi.org/10.3102/1076998611417628" class="external-link">https://doi.org/10.3102/1076998611417628</a>.
</div>
<div id="ref-kochCrossClassifiedCFAMTMMModel2016" class="csl-entry">
Koch, Tobias, Martin Schultze, Minjeong Jeon, Fridtjof W. Nussbeck,
Anna-Katharina Praetorius, and Michael Eid. 2016. <span>“A
<span>Cross-Classified CFA-MTMM Model</span> for <span>Structurally
Different</span> and <span>Nonindependent Interchangeable
Methods</span>.”</span> <em>Multivariate Behavioral Research</em> 51
(1): 67–85. <a href="https://doi.org/10.1080/00273171.2015.1101367" class="external-link">https://doi.org/10.1080/00273171.2015.1101367</a>.
</div>
<div id="ref-mccaffreyModelsValueAddedModeling2004" class="csl-entry">
McCaffrey, Daniel F., J. R. Lockwood, Daniel Koretz, Thomas A. Louis,
and Laura Hamilton. 2004. <span>“Models for <span>Value-Added
Modeling</span> of <span>Teacher Effects</span>.”</span> <em>Journal of
Educational and Behavioral Statistics</em> 29 (1): 67–101. <a href="https://doi.org/10.3102/10769986029001067" class="external-link">https://doi.org/10.3102/10769986029001067</a>.
</div>
<div id="ref-rabe-heskethGeneralizedMultilevelStructural2004" class="csl-entry">
Rabe-Hesketh, Sophia, Anders Skrondal, and Andrew Pickles. 2004.
<span>“Generalized Multilevel Structural Equation Modeling.”</span>
<em>Psychometrika</em> 69 (2): 167–90. <a href="https://doi.org/10.1007/BF02295939" class="external-link">https://doi.org/10.1007/BF02295939</a>.
</div>
<div id="ref-rockwoodEstimatingComplexMeasurement2019" class="csl-entry">
Rockwood, Nicholas J., and Minjeong Jeon. 2019. <span>“Estimating
<span>Complex Measurement</span> and <span>Growth Models Using</span>
the <span>R Package PLmixed</span>.”</span> <em>Multivariate Behavioral
Research</em> 54 (2): 288–306. <a href="https://doi.org/10.1080/00273171.2018.1516541" class="external-link">https://doi.org/10.1080/00273171.2018.1516541</a>.
</div>
<div id="ref-skrondalGeneralizedLatentVariable2004" class="csl-entry">
Skrondal, Anders, and Sophia Rabe-Hesketh. 2004. <em>Generalized Latent
Variable Modeling</em>. Interdisciplinary <span>Statistics
Series</span>. Boca Raton, Florida: <span>Chapman and Hall/CRC</span>.
</div>
<div id="ref-sorensenLongitudinalModelingAgeDependent2023" class="csl-entry">
Sørensen, Øystein, Anders M. Fjell, and Kristine B. Walhovd. 2023.
<span>“Longitudinal <span>Modeling</span> of <span>Age-Dependent Latent
Traits</span> with <span>Generalized Additive Latent</span> and
<span>Mixed Models</span>.”</span> <em>Psychometrika</em> 88 (2):
456–86. <a href="https://doi.org/10.1007/s11336-023-09910-z" class="external-link">https://doi.org/10.1007/s11336-023-09910-z</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Øystein Sørensen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
