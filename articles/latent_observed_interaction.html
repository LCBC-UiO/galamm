<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Interactions Between Latent and Observed Covariates ‚Ä¢ galamm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Interactions Between Latent and Observed Covariates">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">galamm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/galamm.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/lmm_factor.html">Linear Mixed Models with Factor Structures</a></li>
    <li><a class="dropdown-item" href="../articles/glmm_factor.html">Generalized Linear Mixed Models with Factor Structures</a></li>
    <li><a class="dropdown-item" href="../articles/lmm_heteroscedastic.html">Heteroscedastic Linear Mixed Models</a></li>
    <li><a class="dropdown-item" href="../articles/latent_observed_interaction.html">Interactions Between Latent and Observed Covariates</a></li>
    <li><a class="dropdown-item" href="../articles/mixed_response.html">Models with Mixed Response Types</a></li>
    <li><a class="dropdown-item" href="../articles/semiparametric.html">Semiparametric Latent Variable Modeling</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced topics</h6></li>
    <li><a class="dropdown-item" href="../articles/scaling.html">Computational Scaling</a></li>
    <li><a class="dropdown-item" href="../articles/optimization.html">Optimization</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/LCBC-UiO/galamm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Interactions Between Latent and Observed Covariates</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/LCBC-UiO/galamm/blob/main/vignettes/latent_observed_interaction.Rmd" class="external-link"><code>vignettes/latent_observed_interaction.Rmd</code></a></small>
      <div class="d-none name"><code>latent_observed_interaction.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/LCBC-UiO/galamm" class="external-link">galamm</a></span><span class="op">)</span></span></code></pre></div>
<p>This vignette describes how <code>galamm</code> can be used to model
interactions between latent and observed variables. The models described
here can be considered extensions of the covariate measurement error
model described in the <a href="https://lcbc-uio.github.io/galamm/articles/mixed_response.html#covariate-measurement-error-model">vignette
on mixed response types</a>, by allowing the latent variables to
interaction with observed variables.</p>
<div class="section level3">
<h3 id="linear-mixed-model-with-latent-covariates">Linear Mixed Model with Latent Covariates<a class="anchor" aria-label="anchor" href="#linear-mixed-model-with-latent-covariates"></a>
</h3>
<p>For this example we use the simulated <code>latent_covariates</code>
dataset, of which the first six rows are displayed below:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">latent_covariates</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id         type         x            y response</span></span>
<span><span class="co">#&gt; 1  1 measurement1 0.2655087 -0.530999307        0</span></span>
<span><span class="co">#&gt; 2  1 measurement2 0.2655087 -0.911206495        0</span></span>
<span><span class="co">#&gt; 3  1     response 0.2655087  0.483055528        1</span></span>
<span><span class="co">#&gt; 4  2 measurement1 0.3721239  0.003752663        0</span></span>
<span><span class="co">#&gt; 5  2 measurement2 0.3721239  0.220165165        0</span></span>
<span><span class="co">#&gt; 6  2     response 0.3721239  0.327782922        1</span></span></code></pre></div>
<div class="section level4">
<h4 id="model-formulation">Model Formulation<a class="anchor" aria-label="anchor" href="#model-formulation"></a>
</h4>
<p>The response variable <code>y</code> contains both measurements of a
latent variable and measurements of the response that we actually are
interested in modeling, and the <code>type</code> variable distinguishes
these responses. In this case we have complete observations for each
subject ID, and for a given ID, the measurement model can be written as
follows:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>y</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>y</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>y</mi><mn>3</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>ùõÉ</mi><mn>0</mn></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>x</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œª</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œª</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œª</mi><mn>4</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mi>Œ∑</mi><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>x</mi><mi>Œ≤</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>ùõú</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
\begin{pmatrix}
y_{1} \\
y_{2} \\
y_{3}
\end{pmatrix}
=
\boldsymbol{\beta}_{0} +
\begin{pmatrix}
1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; x
\end{pmatrix}
\begin{pmatrix}
1 \\
\lambda_{2} \\
\lambda_{3} \\
\lambda_{4}
\end{pmatrix}
\eta 
+
\begin{pmatrix}
0 \\
0 \\
x \beta
\end{pmatrix}
+ \boldsymbol{\epsilon}.
</annotation></semantics></math></p>
<p>In this equation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùõÉ</mi><mn>0</mn></msub><mo>‚àà</mo><msup><mi>‚Ñù</mi><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{\beta}_{0} \in \mathbb{R}^{3}</annotation></semantics></math>
is a vector of intercepts,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
is a latent variable, the loading of the latent variable onto the first
measurement
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mn>1</mn></msub><annotation encoding="application/x-tex">y_{1}</annotation></semantics></math>
is fixed to 1 for identifiability,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œª</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\lambda_{2}</annotation></semantics></math>
is the loading of the latent variable onto the second measurement
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mn>2</mn></msub><annotation encoding="application/x-tex">y_{2}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œª</mi><mn>3</mn></msub><annotation encoding="application/x-tex">\lambda_{3}</annotation></semantics></math>
is the main effect of the latent variable on the response of interest
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mn>3</mn></msub><annotation encoding="application/x-tex">y_{3}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ≤</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
is the effect of the observed covariate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mn>3</mn></msub><annotation encoding="application/x-tex">y_{3}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œª</mi><mn>4</mn></msub><annotation encoding="application/x-tex">\lambda_{4}</annotation></semantics></math>
is the interaction effect of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mn>3</mn></msub><annotation encoding="application/x-tex">y_{3}</annotation></semantics></math>.
We assume that the residuals
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõú</mi><annotation encoding="application/x-tex">\boldsymbol{\epsilon}</annotation></semantics></math>
are independently and identically normally distributed; this assumption
is valid in this simulated case, but note that since the response
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mn>3</mn></msub><annotation encoding="application/x-tex">y_{3}</annotation></semantics></math>
is qualitatively different from the measurements
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mn>1</mn></msub><annotation encoding="application/x-tex">y_{1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mn>2</mn></msub><annotation encoding="application/x-tex">y_{2}</annotation></semantics></math>,
this assumption will in general not hold, and a <a href="https://lcbc-uio.github.io/galamm/articles/lmm_heteroscedastic.html">heteroscedastic
measurement model</a> should be used, or a <a href="https://lcbc-uio.github.io/galamm/articles/mixed_response.html">model
with mixed response types</a>. For a more detailed explanation of this
way of formulating latent variable models in matrix form we refer to the
first four pages of <span class="citation">Rockwood and Jeon (<a href="#ref-rockwoodEstimatingComplexMeasurement2019">2019</a>)</span>.</p>
<p>The structural model is simply
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∑</mi><mo>=</mo><mi>Œ∂</mi><mo>‚àº</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>œà</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\eta = \zeta \sim N(0, \psi)</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œà</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
is its variance.</p>
</div>
<div class="section level4">
<h4 id="model-without-interaction">Model Without Interaction<a class="anchor" aria-label="anchor" href="#model-without-interaction"></a>
</h4>
<p>It can be instructive to start by considering a model in which we fix
<span class="math inline">$\\lambda_{4} = 0$</span>. This type of model
would be estimated with the following code:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/galamm.html">galamm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">type</span> <span class="op">+</span> <span class="va">x</span><span class="op">:</span><span class="va">response</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">loading</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">latent_covariates</span>,</span>
<span>  load.var <span class="op">=</span> <span class="st">"type"</span>,</span>
<span>  lambda <span class="op">=</span> <span class="va">lambda</span>,</span>
<span>  factor <span class="op">=</span> <span class="st">"loading"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In the data generating simulations, the true values were
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œª</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lambda_{1}=1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œª</mi><mn>2</mn></msub><mo>=</mo><mn>1.3</mn></mrow><annotation encoding="application/x-tex">\lambda_{2} = 1.3</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œª</mi><mn>3</mn></msub><mo>=</mo><mo>‚àí</mo><mn>0.3</mn></mrow><annotation encoding="application/x-tex">\lambda_{3} = -0.3</annotation></semantics></math>.
The former two are very well recovered, but the latter is too positive,
which is likely due to us omitting the interaction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œª</mi><mn>4</mn></msub><annotation encoding="application/x-tex">\lambda_{4}</annotation></semantics></math>,
whose true value was 0.2.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod0</span><span class="op">)</span></span>
<span><span class="co">#&gt; GALAMM fit by maximum marginal likelihood.</span></span>
<span><span class="co">#&gt; Formula: y ~ type + x:response + (0 + loading | id)</span></span>
<span><span class="co">#&gt;    Data: latent_covariates</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;    197.5    232.7    -90.8    181.5      592 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2.92130 -0.52315 -0.01058  0.52532  3.01104 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Lambda:</span></span>
<span><span class="co">#&gt;         loading       SE</span></span>
<span><span class="co">#&gt; lambda1  1.0000        .</span></span>
<span><span class="co">#&gt; lambda2  1.3033 0.013687</span></span>
<span><span class="co">#&gt; lambda3 -0.2063 0.008515</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name    Variance Std.Dev.</span></span>
<span><span class="co">#&gt;  id       loading 0.98112  0.9905  </span></span>
<span><span class="co">#&gt;  Residual         0.01357  0.1165  </span></span>
<span><span class="co">#&gt; Number of obs: 600, groups:  id, 200</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;                   Estimate Std. Error  t value  Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept)      -0.010588    0.07052 -0.15014 8.807e-01</span></span>
<span><span class="co">#&gt; typemeasurement2 -0.002173    0.02423 -0.08968 9.285e-01</span></span>
<span><span class="co">#&gt; typeresponse      0.029353    0.08678  0.33826 7.352e-01</span></span>
<span><span class="co">#&gt; x:response        0.470444    0.03093 15.20943 3.062e-52</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="linear-interaction-between-observed-and-latent-covariates">Linear Interaction Between Observed and Latent Covariates<a class="anchor" aria-label="anchor" href="#linear-interaction-between-observed-and-latent-covariates"></a>
</h4>
<p>The measurement model can be equivalently written as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>y</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>y</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>y</mi><mn>3</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>ùõÉ</mi><mn>0</mn></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œª</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œª</mi><mn>3</mn></msub><mo>+</mo><msub><mi>Œª</mi><mn>4</mn></msub><mi>x</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mi>Œ∑</mi><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>x</mi><mi>Œ≤</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>ùõú</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
\begin{pmatrix}
y_{1} \\
y_{2} \\
y_{3}
\end{pmatrix}
=
\boldsymbol{\beta}_{0} +
\begin{pmatrix}
1 \\
\lambda_{2} \\
\lambda_{3} + \lambda_{4} x
\end{pmatrix}
\eta 
+
\begin{pmatrix}
0 \\
0 \\
x \beta
\end{pmatrix}
+ \boldsymbol{\epsilon}.
</annotation></semantics></math></p>
<p>This way of writing shows more explicitly which factor loadings are
connected with which observation. In order to fit this model with
<code>galamm</code>, we must provide formulas for the terms in the
loading matrix</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œª</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Œª</mi><mn>3</mn></msub><mo>+</mo><msub><mi>Œª</mi><mn>4</mn></msub><mi>x</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\begin{pmatrix}
1 \\
\lambda_{2} \\
\lambda_{3} + \lambda_{4} x
\end{pmatrix}.
</annotation></semantics></math></p>
<p>We specify the factor interactions with a list, one for each row of
<code>lambda</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">factor_interactions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p>This specifies that for the first two rows, there are no covariates,
but for the third row, we want a linear regression with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
as covariate. Next, we specify the loading matrix
<strong>without</strong> the interaction parameter, i.e., we reuse the
<code>lambda</code> object that was specified for <code>mod0</code>
above. This lets us fit the model as follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/galamm.html">galamm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">type</span> <span class="op">+</span> <span class="va">x</span><span class="op">:</span><span class="va">response</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">loading</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">latent_covariates</span>,</span>
<span>  load.var <span class="op">=</span> <span class="st">"type"</span>,</span>
<span>  lambda <span class="op">=</span> <span class="va">lambda</span>,</span>
<span>  factor <span class="op">=</span> <span class="st">"loading"</span>,</span>
<span>  factor_interactions <span class="op">=</span> <span class="va">factor_interactions</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>A model comparison shows overwhelming evidence in favor of this
model, which is not surprising since this is how the data were
simulated.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">mod0</span><span class="op">)</span></span>
<span><span class="co">#&gt; Data: latent_covariates</span></span>
<span><span class="co">#&gt; Models:</span></span>
<span><span class="co">#&gt; mod0: y ~ type + x:response + (0 + loading | id)</span></span>
<span><span class="co">#&gt; mod: y ~ type + x:response + (0 + loading | id)</span></span>
<span><span class="co">#&gt;      npar    AIC    BIC  logLik deviance Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">#&gt; mod0    8 197.52 232.70 -90.761   120.31                        </span></span>
<span><span class="co">#&gt; mod     9 138.31 177.88 -60.155   120.31 61.21  1  5.129e-15 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>The summary also shows that the bias in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œª</mi><mn>3</mn></msub><annotation encoding="application/x-tex">\lambda_{3}</annotation></semantics></math>
has basically disappeared, as it is up to -0.318 from -0.195, with the
true value being -0.3. The interaction is estimated at 0.233, which is
also very close to the true value 0.2. It should of course be noted here
that the noise level in this simulated dataset was set unrealistically
low, to let us confirm that the implementation itself is correct.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; GALAMM fit by maximum marginal likelihood.</span></span>
<span><span class="co">#&gt; Formula: y ~ type + x:response + (0 + loading | id)</span></span>
<span><span class="co">#&gt;    Data: latent_covariates</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;    138.3    177.9    -60.2    120.3      591 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -2.2033 -0.5251 -0.0273  0.5146  3.5029 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Lambda:</span></span>
<span><span class="co">#&gt;           loading      SE</span></span>
<span><span class="co">#&gt; lambda1    1.0000       .</span></span>
<span><span class="co">#&gt; lambda2    1.3034 0.01268</span></span>
<span><span class="co">#&gt; lambda3   -0.3183 0.01604</span></span>
<span><span class="co">#&gt; lambda4_x  0.2331 0.02873</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name    Variance Std.Dev.</span></span>
<span><span class="co">#&gt;  id       loading 0.98175  0.9908  </span></span>
<span><span class="co">#&gt;  Residual         0.01164  0.1079  </span></span>
<span><span class="co">#&gt; Number of obs: 600, groups:  id, 200</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;                   Estimate Std. Error  t value  Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept)      -0.010589    0.07048 -0.15024 8.806e-01</span></span>
<span><span class="co">#&gt; typemeasurement2 -0.002173    0.02384 -0.09116 9.274e-01</span></span>
<span><span class="co">#&gt; typeresponse      0.034005    0.09417  0.36109 7.180e-01</span></span>
<span><span class="co">#&gt; x:response        0.462507    0.03300 14.01556 1.252e-44</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="interaction-between-latent-covariate-and-a-quadratic-term">Interaction Between Latent Covariate and a Quadratic Term<a class="anchor" aria-label="anchor" href="#interaction-between-latent-covariate-and-a-quadratic-term"></a>
</h4>
<p>We can also try to add interactions between the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>x</mi><mn>2</mn></msup><annotation encoding="application/x-tex">x^{2}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>.
We first update the formula in <code>factor_interactions</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">factor_interactions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Then we fit the model as before:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/galamm.html">galamm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">type</span> <span class="op">+</span> <span class="va">x</span><span class="op">:</span><span class="va">response</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">loading</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">latent_covariates</span>,</span>
<span>  load.var <span class="op">=</span> <span class="st">"type"</span>,</span>
<span>  lambda <span class="op">=</span> <span class="va">lambda</span>,</span>
<span>  factor <span class="op">=</span> <span class="st">"loading"</span>,</span>
<span>  factor_interactions <span class="op">=</span> <span class="va">factor_interactions</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>As can be seen, the coefficient for this squared interaction is not
significantly different from zero.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span><span class="co">#&gt; GALAMM fit by maximum marginal likelihood.</span></span>
<span><span class="co">#&gt; Formula: y ~ type + x:response + (0 + loading | id)</span></span>
<span><span class="co">#&gt;    Data: latent_covariates</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;    140.3    184.2    -60.1    120.3      590 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -2.2012 -0.5212 -0.0228  0.5173  3.4968 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Lambda:</span></span>
<span><span class="co">#&gt;                 loading      SE</span></span>
<span><span class="co">#&gt; lambda1         1.00000       .</span></span>
<span><span class="co">#&gt; lambda2         1.30340 0.01267</span></span>
<span><span class="co">#&gt; lambda3        -0.31418 0.02446</span></span>
<span><span class="co">#&gt; lambda4_x       0.20906 0.11252</span></span>
<span><span class="co">#&gt; lambda5_I(x^2)  0.02453 0.11097</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name    Variance Std.Dev.</span></span>
<span><span class="co">#&gt;  id       loading 0.98175  0.9908  </span></span>
<span><span class="co">#&gt;  Residual         0.01164  0.1079  </span></span>
<span><span class="co">#&gt; Number of obs: 600, groups:  id, 200</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;                   Estimate Std. Error  t value  Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept)      -0.009919    0.07054 -0.14062 8.882e-01</span></span>
<span><span class="co">#&gt; typemeasurement2 -0.001969    0.02385 -0.08256 9.342e-01</span></span>
<span><span class="co">#&gt; typeresponse      0.033289    0.09426  0.35316 7.240e-01</span></span>
<span><span class="co">#&gt; x:response        0.462228    0.03305 13.98397 1.953e-44</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="models-with-additional-random-effects">Models with Additional Random Effects<a class="anchor" aria-label="anchor" href="#models-with-additional-random-effects"></a>
</h3>
<p>It is also straightforward to include additional random effects in
models containing interactions between latent and observed covariates.
The dataset <code>latent_covariates_long</code> is similar to
<code>latent_covariates</code> that was used above, but it has six
repeated measurements of the response for each subject. The first ten
rows of the dataset are shown below.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">latent_covariates_long</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;    id         type         x            y response</span></span>
<span><span class="co">#&gt; 1   1 measurement1 0.2655087 -0.530999307        0</span></span>
<span><span class="co">#&gt; 2   1 measurement2 0.2655087 -0.911206495        0</span></span>
<span><span class="co">#&gt; 3   1     response 0.2655087  0.250414575        1</span></span>
<span><span class="co">#&gt; 4   1     response 0.2655087  0.702355328        1</span></span>
<span><span class="co">#&gt; 5   2 measurement1 0.3721239  0.003752663        0</span></span>
<span><span class="co">#&gt; 6   2 measurement2 0.3721239  0.220165165        0</span></span>
<span><span class="co">#&gt; 7   2     response 0.3721239  0.337374818        1</span></span>
<span><span class="co">#&gt; 8   2     response 0.3721239  0.315766396        1</span></span>
<span><span class="co">#&gt; 9   3 measurement1 0.5728534 -0.902625075        0</span></span>
<span><span class="co">#&gt; 10  3 measurement2 0.5728534 -1.127476052        0</span></span></code></pre></div>
<p>For these data we add a random intercept for the response terms, in
addition to the terms that were used above. We start by resetting the
interaction models to a linear term:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">factor_interactions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p>Next we fit the model using <code>galamm</code>. The difference to
notice here is that we added <code>(0 + response | id)</code> to the
formula. This implies that for observations that are responses, for
which <code>response = 1</code>, there should be a random intercept per
subject.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/galamm.html">galamm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">type</span> <span class="op">+</span> <span class="va">x</span><span class="op">:</span><span class="va">response</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">loading</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">response</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">latent_covariates_long</span>,</span>
<span>  load.var <span class="op">=</span> <span class="st">"type"</span>,</span>
<span>  lambda <span class="op">=</span> <span class="va">lambda</span>,</span>
<span>  factor <span class="op">=</span> <span class="st">"loading"</span>,</span>
<span>  factor_interactions <span class="op">=</span> <span class="va">factor_interactions</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>From the summary, we see that also in this case the factor loadings
are very well recovered.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; GALAMM fit by maximum marginal likelihood.</span></span>
<span><span class="co">#&gt; Formula: y ~ type + x:response + (0 + loading | id) + (0 + response |      id)</span></span>
<span><span class="co">#&gt;    Data: latent_covariates_long</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;    150.6    197.5    -65.3    130.6      790 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -3.3804 -0.5291 -0.0199  0.5126  3.5849 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Lambda:</span></span>
<span><span class="co">#&gt;           loading      SE</span></span>
<span><span class="co">#&gt; lambda1    1.0000       .</span></span>
<span><span class="co">#&gt; lambda2    1.3036 0.01672</span></span>
<span><span class="co">#&gt; lambda3   -0.3279 0.01539</span></span>
<span><span class="co">#&gt; lambda4_x  0.2415 0.02730</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name     Variance Std.Dev.</span></span>
<span><span class="co">#&gt;  id       loading  0.97824  0.9891  </span></span>
<span><span class="co">#&gt;  id.1     response 0.00000  0.0000  </span></span>
<span><span class="co">#&gt;  Residual          0.02018  0.1420  </span></span>
<span><span class="co">#&gt; Number of obs: 800, groups:  id, 200</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;                   Estimate Std. Error  t value  Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept)      -0.010585    0.07065 -0.14981 8.809e-01</span></span>
<span><span class="co">#&gt; typemeasurement2 -0.002171    0.02555 -0.08498 9.323e-01</span></span>
<span><span class="co">#&gt; typeresponse      0.033712    0.09473  0.35590 7.219e-01</span></span>
<span><span class="co">#&gt; x:response        0.474623    0.03178 14.93242 2.028e-50</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-with-smooth-terms">Model with Smooth Terms<a class="anchor" aria-label="anchor" href="#model-with-smooth-terms"></a>
</h3>
<p>We can also include smooth terms in models containing interactions
between latent and observed variables. In this example, we replace the
linear term <code>x:response</code> with a smooth term
<code>s(x, by = response)</code>. Since this smooth term also includes
the main effect of <code>response</code>, which corresponds to an
intercept for the response observations, we must remove the
<code>type</code> term and instead insert two dummy variables, one for
each measurement. We first create these dummy variables:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">latent_covariates</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"measurement1"</span><span class="op">)</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"measurement2"</span><span class="op">)</span></span></code></pre></div>
<p>We then fit the model:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/galamm.html">galamm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">m1</span> <span class="op">+</span> <span class="va">m2</span> <span class="op">+</span> <span class="fu"><a href="../reference/sl.html">s</a></span><span class="op">(</span><span class="va">x</span>, by <span class="op">=</span> <span class="va">response</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">loading</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>  load.var <span class="op">=</span> <span class="st">"type"</span>,</span>
<span>  lambda <span class="op">=</span> <span class="va">lambda</span>,</span>
<span>  factor <span class="op">=</span> <span class="st">"loading"</span>,</span>
<span>  factor_interactions <span class="op">=</span> <span class="va">factor_interactions</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The summary output again suggest that the factor loadings are very
well recovered.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; GALAMM fit by maximum marginal likelihood.</span></span>
<span><span class="co">#&gt; Formula: y ~ 0 + m1 + m2 + s(x, by = response) + (0 + loading | id)</span></span>
<span><span class="co">#&gt;    Data: dat</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;    140.3    184.3    -60.2    120.3      590 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -2.2032 -0.5251 -0.0273  0.5146  3.5029 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Lambda:</span></span>
<span><span class="co">#&gt;           loading      SE</span></span>
<span><span class="co">#&gt; lambda1    1.0000       .</span></span>
<span><span class="co">#&gt; lambda2    1.3034 0.01268</span></span>
<span><span class="co">#&gt; lambda3   -0.3183 0.01604</span></span>
<span><span class="co">#&gt; lambda4_x  0.2331 0.02873</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name          Variance Std.Dev.</span></span>
<span><span class="co">#&gt;  id       loading       0.98175  0.9908  </span></span>
<span><span class="co">#&gt;  Xr       s(x):response 0.00000  0.0000  </span></span>
<span><span class="co">#&gt;  Residual               0.01164  0.1079  </span></span>
<span><span class="co">#&gt; Number of obs: 600, groups:  id, 200; Xr, 8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;                  Estimate Std. Error t value  Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; m1               -0.01059   0.070477 -0.1503 8.805e-01</span></span>
<span><span class="co">#&gt; m2               -0.01276   0.091638 -0.1393 8.892e-01</span></span>
<span><span class="co">#&gt; s(x):responseFx1  0.12412   0.008856 14.0155 1.252e-44</span></span>
<span><span class="co">#&gt; s(x):responseFx2  0.26284   0.015809 16.6255 4.558e-62</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span><span class="co">#&gt;               edf Ref.df     F p-value</span></span>
<span><span class="co">#&gt; s(x):response   2      2 417.2  &lt;2e-16</span></span></code></pre></div>
<p>We can also plot the smooth term, which is linear. That is, in this
case the smooth term was not necessary. Not that we can also see this
from the zero variance estimate of the random effect named
<code>s(x):response</code> in the summary above, which mean that the
smoothing parameter for this term is infinite, and hence that the smooth
term is exactly linear.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_smooth.galamm.html">plot_smooth</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="latent-observed-smooth-1.png" alt="Smooth term in model with interaction between latent and observed covariates."><div class="figcaption">Smooth term in model with interaction between
latent and observed covariates.</div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-rockwoodEstimatingComplexMeasurement2019" class="csl-entry">
Rockwood, Nicholas J., and Minjeong Jeon. 2019. <span>‚ÄúEstimating
<span>Complex Measurement</span> and <span>Growth Models Using</span>
the <span>R Package PLmixed</span>.‚Äù</span> <em>Multivariate Behavioral
Research</em> 54 (2): 288‚Äì306. <a href="https://doi.org/10.1080/00273171.2018.1516541" class="external-link">https://doi.org/10.1080/00273171.2018.1516541</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by √òystein S√∏rensen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
