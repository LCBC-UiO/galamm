<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="galamm">
<title>Interactions Between Latent and Observed Variables • galamm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Interactions Between Latent and Observed Variables">
<meta property="og:description" content="galamm">
<meta property="og:image" content="https://lcbc-uio.github.io/galamm/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">galamm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/galamm.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/lmm_factor.html">Linear Mixed Models with Factor Structures</a>
    <a class="dropdown-item" href="../articles/glmm_factor.html">Generalized Linear Mixed Models with Factor Structures</a>
    <a class="dropdown-item" href="../articles/lmm_heteroscedastic.html">Heteroscedastic Linear Mixed Models</a>
    <a class="dropdown-item" href="../articles/latent_observed_interaction.html">Interactions Between Latent and Observed Variables</a>
    <a class="dropdown-item" href="../articles/mixed_response.html">Models with Mixed Response Types</a>
    <a class="dropdown-item" href="../articles/semiparametric.html">Semiparametric Latent Variable Modeling</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Advanced topics</h6>
    <a class="dropdown-item" href="../articles/optimization.html">Optimization</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/LCBC-UiO/galamm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Interactions Between Latent and Observed Variables</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/LCBC-UiO/galamm/blob/HEAD/vignettes/latent_observed_interaction.Rmd" class="external-link"><code>vignettes/latent_observed_interaction.Rmd</code></a></small>
      <div class="d-none name"><code>latent_observed_interaction.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/LCBC-UiO/galamm" class="external-link">galamm</a></span><span class="op">)</span></span></code></pre></div>
<p>This vignette describes how <code>galamm</code> can be used to model
interactions between latent and observed variables. The models described
here can be considered extensions of the covariate measurement error
model described in the <a href="https://lcbc-uio.github.io/galamm/articles/mixed_response.html#covariate-measurement-error-model">vignette
on mixed response types</a>, by allowing the latent variables to
interaction with observed variables.</p>
<div class="section level3">
<h3 id="linear-mixed-model-with-latent-covariates">Linear Mixed Model with Latent Covariates<a class="anchor" aria-label="anchor" href="#linear-mixed-model-with-latent-covariates"></a>
</h3>
<p>For this example we use the simulated <code>latent_covariates</code>
dataset, of which the first six rows are displayed below:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">latent_covariates</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id         type         x          y response</span></span>
<span><span class="co">#&gt; 1  1 measurement1 0.8954758  0.7344445        0</span></span>
<span><span class="co">#&gt; 2  1 measurement2 0.8954758  0.8776636        0</span></span>
<span><span class="co">#&gt; 3  1     response 0.8954758  0.5012116        1</span></span>
<span><span class="co">#&gt; 4  2 measurement1 0.2871962 -1.6300863        0</span></span>
<span><span class="co">#&gt; 5  2 measurement2 0.2871962 -2.3726788        0</span></span>
<span><span class="co">#&gt; 6  2     response 0.2871962  0.6161934        1</span></span></code></pre></div>
<div class="section level4">
<h4 id="model-formulation">Model Formulation<a class="anchor" aria-label="anchor" href="#model-formulation"></a>
</h4>
<p>The response variable <code>y</code> contains both measurements of a
latent variable and measurements of the response that we actually are
interested in modeling, and the <code>type</code> variable distinguishes
these responses. In this case we have complete observations for each
subject ID, and for a given ID, the measurement model can be written as
follows:</p>
<p><span class="math display">\[
\begin{pmatrix}
y_{1} \\
y_{2} \\
y_{3}
\end{pmatrix}
=
\boldsymbol{\beta}_{0} +
\begin{pmatrix}
1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; x
\end{pmatrix}
\begin{pmatrix}
1 \\
\lambda_{2} \\
\lambda_{3} \\
\lambda_{4}
\end{pmatrix}
\eta
+
\begin{pmatrix}
0 \\
0 \\
x \beta
\end{pmatrix}
+ \boldsymbol{\epsilon}.
\]</span></p>
<p>In this equation <span class="math inline">\(\boldsymbol{\beta}_{0}
\in \mathbb{R}^{3}\)</span> is a vector of intercepts, <span class="math inline">\(\eta\)</span> is a latent variable, the loading of
the latent variable onto the first measurement <span class="math inline">\(y_{1}\)</span> is fixed to 1 for identifiability,
<span class="math inline">\(\lambda_{2}\)</span> is the loading of the
latent variable onto the second measurement <span class="math inline">\(y_{2}\)</span>, <span class="math inline">\(\lambda_{3}\)</span> is the main effect of the
latent variable on the response of interest <span class="math inline">\(y_{3}\)</span>, <span class="math inline">\(\beta\)</span> is the effect of the observed
covariate <span class="math inline">\(x\)</span> on <span class="math inline">\(y_{3}\)</span>, and <span class="math inline">\(\lambda_{4}\)</span> is the interaction effect of
<span class="math inline">\(x\)</span> and <span class="math inline">\(\eta\)</span> on <span class="math inline">\(y_{3}\)</span>. We assume that the residuals <span class="math inline">\(\boldsymbol{\epsilon}\)</span> are independently
and identically normally distributed; this assumption is valid in this
simulated case, but note that since the response <span class="math inline">\(y_{3}\)</span> is qualitatively different from the
measurements <span class="math inline">\(y_{1}\)</span> and <span class="math inline">\(y_{2}\)</span>, this assumption will in general
not hold, and a <a href="https://lcbc-uio.github.io/galamm/articles/lmm_heteroscedastic.html">heteroscedastic
measurement model</a> should be used, or a <a href="https://lcbc-uio.github.io/galamm/articles/mixed_response.html">model
with mixed response types</a>. For a more detailed explanation of this
way of formulating latent variable models in matrix form we refer to the
first four pages of <span class="citation">Rockwood and Jeon (<a href="#ref-rockwoodEstimatingComplexMeasurement2019" role="doc-biblioref">2019</a>)</span>.</p>
<p>The structural model is simply <span class="math inline">\(\eta =
\zeta \sim N(0, \psi)\)</span>, where <span class="math inline">\(\psi\)</span> is its variance.</p>
</div>
<div class="section level4">
<h4 id="model-without-interaction">Model Without Interaction<a class="anchor" aria-label="anchor" href="#model-without-interaction"></a>
</h4>
<p>It can be instructive to start by considering a model in which we fix
<span class="math inline">\(\\lambda_{4} = 0\)</span>. This type of
model would be estimated with the following code:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/galamm.html">galamm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">:</span><span class="va">response</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">loading</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">latent_covariates</span>,</span>
<span>  load.var <span class="op">=</span> <span class="st">"type"</span>,</span>
<span>  lambda <span class="op">=</span> <span class="va">lambda</span>,</span>
<span>  factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"loading"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In the data generating simulations, the true values were <span class="math inline">\(\lambda_{1}=1\)</span>, <span class="math inline">\(\lambda_{2} = 1.3\)</span> and <span class="math inline">\(\lambda_{3} = -0.3\)</span>. The former two are
very well recovered, but the latter is too positive, which is likely due
to us omitting the interaction <span class="math inline">\(\lambda_{4}\)</span>, whose true value was
0.2.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod0</span><span class="op">)</span></span>
<span><span class="co">#&gt; GALAMM fit by maximum marginal likelihood.</span></span>
<span><span class="co">#&gt; Formula: y ~ x:response + (0 + loading | id)</span></span>
<span><span class="co">#&gt;    Data: latent_covariates</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;    133.6    159.9    -60.8    121.6      594 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -3.4256 -0.5231 -0.0151  0.4851  3.2519 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Lambda:</span></span>
<span><span class="co">#&gt;         loading       SE</span></span>
<span><span class="co">#&gt; lambda1  1.0000        .</span></span>
<span><span class="co">#&gt; lambda2  1.2915 0.012036</span></span>
<span><span class="co">#&gt; lambda3 -0.1952 0.007513</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name    Variance Std.Dev.</span></span>
<span><span class="co">#&gt;  id       loading 1.05019  1.0248  </span></span>
<span><span class="co">#&gt;  Residual         0.01137  0.1066  </span></span>
<span><span class="co">#&gt; Number of obs: 600, groups:  id, 200</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value  Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept) -0.01275    0.01249  -1.021 3.073e-01</span></span>
<span><span class="co">#&gt; x:response   0.53475    0.02617  20.435 8.092e-93</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="the-full-model">The Full Model<a class="anchor" aria-label="anchor" href="#the-full-model"></a>
</h4>
<p>The measurement model can be equivalently written as</p>
<p><span class="math display">\[
\begin{pmatrix}
y_{1} \\
y_{2} \\
y_{3}
\end{pmatrix}
=
\boldsymbol{\beta}_{0} +
\begin{pmatrix}
1 \\
\lambda_{2} \\
\lambda_{3} + \lambda_{4} x
\end{pmatrix}
\eta
+
\begin{pmatrix}
0 \\
0 \\
x \beta
\end{pmatrix}
+ \boldsymbol{\epsilon}.
\]</span></p>
<p>This way of writing shows more explicitly which factor loadings are
connected with which observation. In order to fit this model with
<code>galamm</code>, we must provide formulas for the terms in the
loading matrix</p>
<p><span class="math display">\[
\begin{pmatrix}
1 \\
\lambda_{2} \\
\lambda_{3} + \lambda_{4} x
\end{pmatrix}.
\]</span></p>
<p>We specify the factor interactions with a list of lists. The reason
for this notation is that we need one list to hold the regression terms
for each loading variable specified in <code>load.var</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">factor_interactions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This specifies that for the first two rows, there are no covariates,
but for the third row, we want a linear regression with <span class="math inline">\(x\)</span> as covariate. Next, we specify the
loading matrix <strong>without</strong> the interaction parameter, i.e.,
we reuse the <code>lambda</code> object that was specified for
<code>mod0</code> above. This lets us fit the model as follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/galamm.html">galamm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">:</span><span class="va">response</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">loading</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">latent_covariates</span>,</span>
<span>  load.var <span class="op">=</span> <span class="st">"type"</span>,</span>
<span>  lambda <span class="op">=</span> <span class="va">lambda</span>,</span>
<span>  factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"loading"</span><span class="op">)</span>,</span>
<span>  factor_interactions <span class="op">=</span> <span class="va">factor_interactions</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>A model comparison shows overwhelming evidence in favor of this
model, which is not surprising since this is how the data were
simulated.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">mod0</span><span class="op">)</span></span>
<span><span class="co">#&gt; Data: latent_covariates</span></span>
<span><span class="co">#&gt; Models:</span></span>
<span><span class="co">#&gt; mod0: y ~ x:response + (0 + loading | id)</span></span>
<span><span class="co">#&gt; mod: y ~ x:response + (0 + loading | id)</span></span>
<span><span class="co">#&gt;      npar     AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    </span></span>
<span><span class="co">#&gt; mod0    6 133.568 159.95 -60.784   59.173                         </span></span>
<span><span class="co">#&gt; mod     7  73.173 103.95 -29.587   59.173 62.395  1   2.81e-15 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>The summary also shows that the bias in <span class="math inline">\(\lambda_{3}\)</span> has basically disappeared, as
it is up to -0.291 from -0.195, with the true value being -0.3. The
interaction is estimated at 0.197, which is also very close to the true
value 0.2. It should of course be noted here that the noise level in
this simulated dataset was set unrealistically low, to let us confirm
that the implementation itself is correct.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; GALAMM fit by maximum marginal likelihood.</span></span>
<span><span class="co">#&gt; Formula: y ~ x:response + (0 + loading | id)</span></span>
<span><span class="co">#&gt;    Data: latent_covariates</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;     73.2    104.0    -29.6     59.2      593 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2.68699 -0.55501  0.01071  0.50135  2.98197 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Lambda:</span></span>
<span><span class="co">#&gt;           loading      SE</span></span>
<span><span class="co">#&gt; lambda1    1.0000       .</span></span>
<span><span class="co">#&gt; lambda2    1.2916 0.01113</span></span>
<span><span class="co">#&gt; lambda3   -0.2907 0.01366</span></span>
<span><span class="co">#&gt; lambda4_x  0.1970 0.02402</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name    Variance Std.Dev.</span></span>
<span><span class="co">#&gt;  id       loading 1.05077  1.02507 </span></span>
<span><span class="co">#&gt;  Residual         0.00972  0.09859 </span></span>
<span><span class="co">#&gt; Number of obs: 600, groups:  id, 200</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error t value   Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept) -0.009083    0.01093 -0.8311  4.059e-01</span></span>
<span><span class="co">#&gt; x:response   0.526535    0.02281 23.0804 7.284e-118</span></span></code></pre></div>
<p>We can also try to add interactions between the <span class="math inline">\(x^{2}\)</span> and <span class="math inline">\(\eta\)</span>, as follows:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">factor_interactions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/galamm.html">galamm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">:</span><span class="va">response</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">loading</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">latent_covariates</span>,</span>
<span>  load.var <span class="op">=</span> <span class="st">"type"</span>,</span>
<span>  lambda <span class="op">=</span> <span class="va">lambda</span>,</span>
<span>  factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"loading"</span><span class="op">)</span>,</span>
<span>  factor_interactions <span class="op">=</span> <span class="va">factor_interactions</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Not as can be seen, the coefficient for this squared interaction is
not significantly different from zero.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span><span class="co">#&gt; GALAMM fit by maximum marginal likelihood.</span></span>
<span><span class="co">#&gt; Formula: y ~ x:response + (0 + loading | id)</span></span>
<span><span class="co">#&gt;    Data: latent_covariates</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;     74.9    110.1    -29.4     58.9      592 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2.68511 -0.54763  0.00713  0.49697  2.98856 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Lambda:</span></span>
<span><span class="co">#&gt;                 loading      SE</span></span>
<span><span class="co">#&gt; lambda1         1.00000       .</span></span>
<span><span class="co">#&gt; lambda2         1.29158 0.01112</span></span>
<span><span class="co">#&gt; lambda3        -0.28302 0.01977</span></span>
<span><span class="co">#&gt; lambda4_x       0.14809 0.09475</span></span>
<span><span class="co">#&gt; lambda5_I(x^2)  0.05069 0.09503</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name    Variance Std.Dev.</span></span>
<span><span class="co">#&gt;  id       loading 1.050763 1.02507 </span></span>
<span><span class="co">#&gt;  Residual         0.009713 0.09855 </span></span>
<span><span class="co">#&gt; Number of obs: 600, groups:  id, 200</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error t value   Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept) -0.009631    0.01097 -0.8783  3.798e-01</span></span>
<span><span class="co">#&gt; x:response   0.527492    0.02286 23.0724 8.773e-118</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-rockwoodEstimatingComplexMeasurement2019" class="csl-entry">
Rockwood, Nicholas J., and Minjeong Jeon. 2019. <span>“Estimating
<span>Complex Measurement</span> and <span>Growth Models Using</span>
the <span>R Package PLmixed</span>.”</span> <em>Multivariate Behavioral
Research</em> 54 (2): 288–306. <a href="https://doi.org/10.1080/00273171.2018.1516541" class="external-link">https://doi.org/10.1080/00273171.2018.1516541</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Øystein Sørensen.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
