<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="galamm">
<title>Generalized Linear Mixed Models with Factor Structures • galamm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generalized Linear Mixed Models with Factor Structures">
<meta property="og:description" content="galamm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">galamm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/glmm_factor.html">Generalized Linear Mixed Models with Factor Structures</a>
    <a class="dropdown-item" href="../articles/introduction.html">Introduction</a>
    <a class="dropdown-item" href="../articles/lmm_factor.html">Linear Mixed Models with Factor Structures</a>
    <a class="dropdown-item" href="../articles/lmm_heteroscedastic.html">Heteroscedastic Linear Mixed Models</a>
    <a class="dropdown-item" href="../articles/mixed_response.html">Models with Mixed Response Types</a>
    <a class="dropdown-item" href="../articles/optimization.html">Optimization</a>
    <a class="dropdown-item" href="../articles/semiparametric.html">Semiparametric Latent Variable Modeling</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/LCBC-UiO/galamm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Generalized Linear Mixed Models with Factor Structures</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/LCBC-UiO/galamm/blob/HEAD/vignettes/glmm_factor.Rmd" class="external-link"><code>vignettes/glmm_factor.Rmd</code></a></small>
      <div class="d-none name"><code>glmm_factor.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/LCBC-UiO/galamm" class="external-link">galamm</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">PLmixed</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span></code></pre></div>
<p>This vignette describes how <code>galamm</code> can be used to
estimate generalized linear mixed models with factor structures. Such
models are an instance of the generalized linear latent and mixed models
(GLLAMM) framework described by <span class="citation">Rabe-Hesketh,
Skrondal, and Pickles (2004)</span>. The R package <code>PLmixed</code>
<span class="citation">(Rockwood and Jeon 2019)</span> estimates such
models using a profile likelihood algorithm initially proposed by <span class="citation">Jeon and Rabe-Hesketh (2012)</span>. The models are
also a special case of generalized additive latent and mixed models
(GALAMM), and in <code>galamm</code> these models are estimated using a
more direct algorithm described in <span class="citation">Sørensen,
Fjell, and Walhovd (2023)</span>.</p>
<p>As for the vignette on linear mixed models, we thank <span class="citation">Rockwood and Jeon (2019)</span> for creating the
<code>PLmixed</code> package, from which we take example datasets, and
on which we have based the formula syntax of <code>galamm</code>.</p>
<div class="section level3">
<h3 id="model-with-binomially-distributed-responses">Model with Binomially Distributed Responses<a class="anchor" aria-label="anchor" href="#model-with-binomially-distributed-responses"></a>
</h3>
<p>We use a simulated dataset from the <code>PLmixed</code> package for
the example in this vignette. In the vignette on linear mixed models
with factor structures, the response was treated as Gaussian. Here we
use the more appropriate assumption that the response is binomially
distributed.</p>
<p>First we set up the factor structures to be used:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"IRTsim"</span><span class="op">)</span></span>
<span><span class="va">IRTsim</span><span class="op">$</span><span class="va">item</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">IRTsim</span><span class="op">$</span><span class="va">item</span><span class="op">)</span></span>
<span><span class="va">irt.lam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>We fit the model as follows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">galamm_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/galamm.html">galamm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">item</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">abil.sid</span> <span class="op">|</span> <span class="va">sid</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">abil.sid</span> <span class="op">|</span> <span class="va">school</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">IRTsim</span>,</span>
<span>  family <span class="op">=</span> <span class="va">binomial</span>,</span>
<span>  load.var <span class="op">=</span> <span class="st">"item"</span>,</span>
<span>  factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"abil.sid"</span><span class="op">)</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">irt.lam</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; N = 11, M = 20 machine precision = 2.22045e-16</span></span>
<span><span class="co">#&gt; At X0, 0 variables are exactly at the bounds</span></span>
<span><span class="co">#&gt; At iterate     0  f=       1521.3  |proj g|=       55.181</span></span>
<span><span class="co">#&gt; At iterate    10  f =       1472.2  |proj g|=       0.19866</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; iterations 16</span></span>
<span><span class="co">#&gt; function evaluations 17</span></span>
<span><span class="co">#&gt; segments explored during Cauchy searches 17</span></span>
<span><span class="co">#&gt; BFGS updates skipped 0</span></span>
<span><span class="co">#&gt; active bounds at final generalized Cauchy point 0</span></span>
<span><span class="co">#&gt; norm of the final projected gradient 0.000864991</span></span>
<span><span class="co">#&gt; final function value 1472.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; F = 1472.2</span></span>
<span><span class="co">#&gt; final  value 1472.199908 </span></span>
<span><span class="co">#&gt; converged</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">galamm_mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; Generalized additive latent and mixed model fit by maximum marginal likelihood.</span></span>
<span><span class="co">#&gt; Formula: y ~ item + (0 + abil.sid | sid) + (0 + abil.sid | school)</span></span>
<span><span class="co">#&gt;    Data: IRTsim</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;   2394.3   2458.3  -1472.2   2372.3     2489 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -2.8884 -0.7335  0.4266  0.6235  3.0410 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Lambda:</span></span>
<span><span class="co">#&gt;   abil.sid     SE</span></span>
<span><span class="co">#&gt; 1   1.0000      .</span></span>
<span><span class="co">#&gt; 2   0.7370 0.1456</span></span>
<span><span class="co">#&gt; 3   0.9351 0.1872</span></span>
<span><span class="co">#&gt; 4   0.6069 0.1261</span></span>
<span><span class="co">#&gt; 5   0.5860 0.1163</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name     Variance Std.Dev.</span></span>
<span><span class="co">#&gt;  sid      abil.sid 1.466    1.211   </span></span>
<span><span class="co">#&gt;  school   abil.sid 1.300    1.140   </span></span>
<span><span class="co">#&gt;  Residual          1.000    1.000   </span></span>
<span><span class="co">#&gt; Number of obs: 2500, groups:  sid, 500; school, 26</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value</span></span>
<span><span class="co">#&gt; (Intercept)   0.5112     0.2617   1.953</span></span>
<span><span class="co">#&gt; item2         0.3256     0.1791   1.818</span></span>
<span><span class="co">#&gt; item3        -0.4491     0.1623  -2.768</span></span>
<span><span class="co">#&gt; item4         0.4930     0.1924   2.562</span></span>
<span><span class="co">#&gt; item5         0.4585     0.1922   2.385</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="binomial-model-with-multiple-trials">Binomial Model with Multiple Trials<a class="anchor" aria-label="anchor" href="#binomial-model-with-multiple-trials"></a>
</h3>
<p>We simulate such data by computing predictions from the model fitted
above, and drawing binomial samples with multiple trials.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">IRTsim</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">trials</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">trials</span>,</span>
<span>  prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">galamm_mod</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt;     sid school item y trials</span></span>
<span><span class="co">#&gt; 1.1   1      1    1 8     10</span></span>
<span><span class="co">#&gt; 1.2   1      1    2 6      6</span></span>
<span><span class="co">#&gt; 1.3   1      1    3 5      5</span></span>
<span><span class="co">#&gt; 1.4   1      1    4 6      9</span></span>
<span><span class="co">#&gt; 1.5   1      1    5 3      5</span></span>
<span><span class="co">#&gt; 2.1   2      1    1 0      6</span></span></code></pre></div>
<p>For binomial models with more than one trial, the response should be
specified <code>cbind(successes, failures)</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">galamm_mod_trials</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/galamm.html">galamm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">trials</span> <span class="op">-</span> <span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="va">item</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">abil.sid</span> <span class="op">|</span> <span class="va">sid</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">abil.sid</span> <span class="op">|</span> <span class="va">school</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>  family <span class="op">=</span> <span class="va">binomial</span>,</span>
<span>  load.var <span class="op">=</span> <span class="st">"item"</span>,</span>
<span>  factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"abil.sid"</span><span class="op">)</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">irt.lam</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; N = 11, M = 20 machine precision = 2.22045e-16</span></span>
<span><span class="co">#&gt; At X0, 0 variables are exactly at the bounds</span></span>
<span><span class="co">#&gt; At iterate     0  f=       3783.2  |proj g|=       342.25</span></span>
<span><span class="co">#&gt; At iterate    10  f =       3498.5  |proj g|=        2.9971</span></span>
<span><span class="co">#&gt; At iterate    20  f =       3498.3  |proj g|=     0.0067479</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; iterations 21</span></span>
<span><span class="co">#&gt; function evaluations 22</span></span>
<span><span class="co">#&gt; segments explored during Cauchy searches 22</span></span>
<span><span class="co">#&gt; BFGS updates skipped 0</span></span>
<span><span class="co">#&gt; active bounds at final generalized Cauchy point 0</span></span>
<span><span class="co">#&gt; norm of the final projected gradient 0.000337171</span></span>
<span><span class="co">#&gt; final function value 3498.29</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; F = 3498.29</span></span>
<span><span class="co">#&gt; final  value 3498.289133 </span></span>
<span><span class="co">#&gt; converged</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">galamm_mod_trials</span><span class="op">)</span></span>
<span><span class="co">#&gt; Generalized additive latent and mixed model fit by maximum marginal likelihood.</span></span>
<span><span class="co">#&gt; Formula: cbind(y, trials - y) ~ item + (0 + abil.sid | sid) + (0 + abil.sid |  </span></span>
<span><span class="co">#&gt;     school)</span></span>
<span><span class="co">#&gt;    Data: dat</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;   2559.4   2623.5  -3498.3   2537.4     2489 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -2.387  1.811  5.116 10.124 42.919 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Lambda:</span></span>
<span><span class="co">#&gt;   abil.sid      SE</span></span>
<span><span class="co">#&gt; 1   1.0000       .</span></span>
<span><span class="co">#&gt; 2   0.7040 0.05234</span></span>
<span><span class="co">#&gt; 3   0.8750 0.06257</span></span>
<span><span class="co">#&gt; 4   0.5744 0.04613</span></span>
<span><span class="co">#&gt; 5   0.6076 0.04829</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name     Variance Std.Dev.</span></span>
<span><span class="co">#&gt;  sid      abil.sid 0.6848   0.8275  </span></span>
<span><span class="co">#&gt;  school   abil.sid 1.1671   1.0803  </span></span>
<span><span class="co">#&gt;  Residual          1.0000   1.0000  </span></span>
<span><span class="co">#&gt; Number of obs: 2500, groups:  sid, 500; school, 26</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value</span></span>
<span><span class="co">#&gt; (Intercept)   0.4768    0.22158   2.152</span></span>
<span><span class="co">#&gt; item2         0.3009    0.09257   3.251</span></span>
<span><span class="co">#&gt; item3        -0.5032    0.07100  -7.087</span></span>
<span><span class="co">#&gt; item4         0.3965    0.11423   3.471</span></span>
<span><span class="co">#&gt; item5         0.4823    0.10859   4.442</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-with-poisson-distributed-responses">Model with Poisson Distributed Responses<a class="anchor" aria-label="anchor" href="#model-with-poisson-distributed-responses"></a>
</h3>
<p>To illustrate the model for counts, we consider an example from
Chapter 11.3 in <span class="citation">Skrondal and Rabe-Hesketh
(2004)</span>. The model does not contain factor loadings, but we use it
to demonstrate how to fit GLMMs with Poisson distributed responses.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/galamm.html">galamm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">lbas</span> <span class="op">*</span> <span class="va">treat</span> <span class="op">+</span> <span class="va">lage</span> <span class="op">+</span> <span class="va">v4</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">subj</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">epilep</span>,</span>
<span>  family <span class="op">=</span> <span class="va">poisson</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; N = 7, M = 20 machine precision = 2.22045e-16</span></span>
<span><span class="co">#&gt; At X0, 0 variables are exactly at the bounds</span></span>
<span><span class="co">#&gt; At iterate     0  f=       773.26  |proj g|=       138.53</span></span>
<span><span class="co">#&gt; At iterate    10  f =       665.95  |proj g|=         9.128</span></span>
<span><span class="co">#&gt; At iterate    20  f =       665.36  |proj g|=       0.01895</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; iterations 22</span></span>
<span><span class="co">#&gt; function evaluations 28</span></span>
<span><span class="co">#&gt; segments explored during Cauchy searches 22</span></span>
<span><span class="co">#&gt; BFGS updates skipped 0</span></span>
<span><span class="co">#&gt; active bounds at final generalized Cauchy point 0</span></span>
<span><span class="co">#&gt; norm of the final projected gradient 0.000368678</span></span>
<span><span class="co">#&gt; final function value 665.359</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; F = 665.359</span></span>
<span><span class="co">#&gt; final  value 665.358735 </span></span>
<span><span class="co">#&gt; converged</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">count_mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; Generalized additive latent and mixed model fit by maximum marginal likelihood.</span></span>
<span><span class="co">#&gt; Formula: y ~ lbas * treat + lage + v4 + (1 | subj)</span></span>
<span><span class="co">#&gt;    Data: epilep</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;    421.0    445.3   -665.4    407.0      229 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -3.1918 -0.8456 -0.0917  0.5839  6.6303 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">#&gt;  subj     (Intercept) 0.2516   0.5016  </span></span>
<span><span class="co">#&gt;  Residual             1.0000   1.0000  </span></span>
<span><span class="co">#&gt; Number of obs: 236, groups:  subj, 59</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value</span></span>
<span><span class="co">#&gt; (Intercept)   1.7936    0.10468  17.134</span></span>
<span><span class="co">#&gt; lbas          0.8845    0.13096   6.754</span></span>
<span><span class="co">#&gt; treat        -0.3350    0.14775  -2.267</span></span>
<span><span class="co">#&gt; lage          0.4846    0.34658   1.398</span></span>
<span><span class="co">#&gt; v4           -0.1611    0.05458  -2.952</span></span>
<span><span class="co">#&gt; lbas:treat    0.3384    0.20293   1.668</span></span></code></pre></div>
<p>In this case we can confirm that the <code>galamm</code> function is
correctly implemented by comparing it to the output of
<code><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">lme4::glmer</a></code>. For a model like this, it would also be best
to use <code>lme4</code>, but with factor structures or other
nonlinearities, <code>lme4</code> no longer provides the flexibility we
need.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span><span class="va">count_mod_lme4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">lbas</span> <span class="op">*</span> <span class="va">treat</span> <span class="op">+</span> <span class="va">lage</span> <span class="op">+</span> <span class="va">v4</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">subj</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">epilep</span>,</span>
<span>  family <span class="op">=</span> <span class="va">poisson</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">count_mod_lme4</span><span class="op">)</span></span>
<span><span class="co">#&gt; Generalized linear mixed model fit by maximum likelihood (Laplace</span></span>
<span><span class="co">#&gt;   Approximation) [glmerMod]</span></span>
<span><span class="co">#&gt;  Family: poisson  ( log )</span></span>
<span><span class="co">#&gt; Formula: y ~ lbas * treat + lage + v4 + (1 | subj)</span></span>
<span><span class="co">#&gt;    Data: epilep</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;   1344.7   1369.0   -665.4   1330.7      229 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -3.1918 -0.8456 -0.0918  0.5837  6.6303 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups Name        Variance Std.Dev.</span></span>
<span><span class="co">#&gt;  subj   (Intercept) 0.2515   0.5015  </span></span>
<span><span class="co">#&gt; Number of obs: 236, groups:  subj, 59</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)   1.7937     0.1045  17.165  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; lbas          0.8844     0.1308   6.764 1.34e-11 ***</span></span>
<span><span class="co">#&gt; treat        -0.3349     0.1474  -2.272  0.02311 *  </span></span>
<span><span class="co">#&gt; lage          0.4845     0.3458   1.401  0.16121    </span></span>
<span><span class="co">#&gt; v4           -0.1611     0.0543  -2.966  0.00301 ** </span></span>
<span><span class="co">#&gt; lbas:treat    0.3382     0.2025   1.671  0.09479 .  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span><span class="co">#&gt;            (Intr) lbas   treat  lage   v4    </span></span>
<span><span class="co">#&gt; lbas       -0.035                            </span></span>
<span><span class="co">#&gt; treat      -0.708  0.024                     </span></span>
<span><span class="co">#&gt; lage       -0.092 -0.037  0.099              </span></span>
<span><span class="co">#&gt; v4          0.015  0.000  0.000  0.000       </span></span>
<span><span class="co">#&gt; lbas:treat  0.001 -0.654 -0.087  0.252  0.000</span></span></code></pre></div>
<p>You might note that the deviance in the summary output of the model
fitted by lme4 is different from the deviance of the model fitted by
galamm. This is because in the summary output, lme4 shows the deviance
as minus two times the log likelihood. In contrast, calling the deviance
function on a model object fitted by glmer gives the same output as
galamm.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></span><span class="op">(</span><span class="va">count_mod_lme4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 407.0092</span></span></code></pre></div>
<p>For details on deviance calculation in lme4, see
<code><a href="https://rdrr.io/pkg/lme4/man/merMod-class.html" class="external-link">help(deviance.merMod, "lme4")</a></code>.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-jeonProfileLikelihoodApproachEstimating2012" class="csl-entry">
Jeon, Minjeong, and Sophia Rabe-Hesketh. 2012.
<span>“Profile-<span>Likelihood Approach</span> for <span>Estimating
Generalized Linear Mixed Models With Factor Structures</span>.”</span>
<em>Journal of Educational and Behavioral Statistics</em> 37 (4):
518–42. <a href="https://doi.org/10.3102/1076998611417628" class="external-link">https://doi.org/10.3102/1076998611417628</a>.
</div>
<div id="ref-rabe-heskethGeneralizedMultilevelStructural2004" class="csl-entry">
Rabe-Hesketh, Sophia, Anders Skrondal, and Andrew Pickles. 2004.
<span>“Generalized Multilevel Structural Equation Modeling.”</span>
<em>Psychometrika</em> 69 (2): 167–90. <a href="https://doi.org/10.1007/BF02295939" class="external-link">https://doi.org/10.1007/BF02295939</a>.
</div>
<div id="ref-rockwoodEstimatingComplexMeasurement2019" class="csl-entry">
Rockwood, Nicholas J., and Minjeong Jeon. 2019. <span>“Estimating
<span>Complex Measurement</span> and <span>Growth Models Using</span>
the <span>R Package PLmixed</span>.”</span> <em>Multivariate Behavioral
Research</em> 54 (2): 288–306. <a href="https://doi.org/10.1080/00273171.2018.1516541" class="external-link">https://doi.org/10.1080/00273171.2018.1516541</a>.
</div>
<div id="ref-skrondalGeneralizedLatentVariable2004" class="csl-entry">
Skrondal, Anders, and Sophia Rabe-Hesketh. 2004. <em>Generalized Latent
Variable Modeling</em>. Interdisciplinary <span>Statistics
Series</span>. <span>Boca Raton, Florida</span>: <span>Chapman and
Hall/CRC</span>.
</div>
<div id="ref-sorensenLongitudinalModelingAgeDependent2023" class="csl-entry">
Sørensen, Øystein, Anders M. Fjell, and Kristine B. Walhovd. 2023.
<span>“Longitudinal <span>Modeling</span> of <span>Age-Dependent Latent
Traits</span> with <span>Generalized Additive Latent</span> and
<span>Mixed Models</span>.”</span> <em>Psychometrika</em> 88 (2):
456–86. <a href="https://doi.org/10.1007/s11336-023-09910-z" class="external-link">https://doi.org/10.1007/s11336-023-09910-z</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Øystein Sørensen.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
