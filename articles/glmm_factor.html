<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Generalized Linear Mixed Models with Factor Structures ‚Ä¢ galamm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="‚Äùimage/svg+xml‚Äù" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generalized Linear Mixed Models with Factor Structures">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">galamm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0.9003</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/galamm.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/lmm_factor.html">Linear Mixed Models with Factor Structures</a></li>
    <li><a class="dropdown-item" href="../articles/glmm_factor.html">Generalized Linear Mixed Models with Factor Structures</a></li>
    <li><a class="dropdown-item" href="../articles/lmm_heteroscedastic.html">Heteroscedastic Linear Mixed Models</a></li>
    <li><a class="dropdown-item" href="../articles/latent_observed_interaction.html">Interactions Between Latent and Observed Covariates</a></li>
    <li><a class="dropdown-item" href="../articles/mixed_response.html">Models with Mixed Response Types</a></li>
    <li><a class="dropdown-item" href="../articles/semiparametric.html">Semiparametric Latent Variable Modeling</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced topics</h6></li>
    <li><a class="dropdown-item" href="../articles/scaling.html">Computational Scaling</a></li>
    <li><a class="dropdown-item" href="../articles/optimization.html">Optimization</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/LCBC-UiO/galamm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generalized Linear Mixed Models with Factor Structures</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/LCBC-UiO/galamm/blob/main/vignettes/glmm_factor.Rmd" class="external-link"><code>vignettes/glmm_factor.Rmd</code></a></small>
      <div class="d-none name"><code>glmm_factor.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/LCBC-UiO/galamm" class="external-link">galamm</a></span><span class="op">)</span></span></code></pre></div>
<p>This vignette describes how <code>galamm</code> can be used to
estimate generalized linear mixed models with factor structures. Such
models are an instance of the generalized linear latent and mixed models
(GLLAMM) framework described by <span class="citation">Rabe-Hesketh,
Skrondal, and Pickles (<a href="#ref-rabe-heskethGeneralizedMultilevelStructural2004">2004</a>)</span>.
The R package PLmixed <span class="citation">(<a href="#ref-rockwoodEstimatingComplexMeasurement2019">Rockwood and Jeon
2019</a>)</span> estimates such models using a profile likelihood
algorithm initially proposed by <span class="citation">Jeon and
Rabe-Hesketh (<a href="#ref-jeonProfileLikelihoodApproachEstimating2012">2012</a>)</span>.
The models are also a special case of generalized additive latent and
mixed models (GALAMM), and in galamm these models are estimated using a
more direct algorithm described in <span class="citation">S√∏rensen,
Fjell, and Walhovd (<a href="#ref-sorensenLongitudinalModelingAgeDependent2023">2023</a>)</span>.</p>
<p>As for the vignette on linear mixed models, we thank <span class="citation">Rockwood and Jeon (<a href="#ref-rockwoodEstimatingComplexMeasurement2019">2019</a>)</span>
for creating the <a href="https://cran.r-project.org/package=PLmixed" class="external-link">PLmixed</a> package,
from which we take example datasets, and on which we have based the
formula syntax of galamm.</p>
<div class="section level3">
<h3 id="model-with-binomially-distributed-responses">Model with Binomially Distributed Responses<a class="anchor" aria-label="anchor" href="#model-with-binomially-distributed-responses"></a>
</h3>
<p>We use a simulated dataset from the PLmixed package for this example.
The observations are binomial responses representing an ability
measurement. The first few lines are shown below.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">PLmixed</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">IRTsim</span><span class="op">)</span></span>
<span><span class="co">#&gt;     sid school item y</span></span>
<span><span class="co">#&gt; 1.1   1      1    1 1</span></span>
<span><span class="co">#&gt; 1.2   1      1    2 1</span></span>
<span><span class="co">#&gt; 1.3   1      1    3 1</span></span>
<span><span class="co">#&gt; 1.4   1      1    4 0</span></span>
<span><span class="co">#&gt; 1.5   1      1    5 1</span></span>
<span><span class="co">#&gt; 2.1   2      1    1 1</span></span></code></pre></div>
<p>Each student is identified by a student id <code>sid</code>, and each
school with a school id given by the <code>school</code> variable. For
each student, five item measurements have been made. We assume that the
student‚Äôs performance depends both on the students ability as well as on
the school the student attends. Having the outline of GALAMMs from the
<a href="https://lcbc-uio.github.io/galamm/articles/galamm.html">introductory
vignette</a> in mind, we assume a binomial response model with a logit
link, yielding for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>th
measurement of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>th
student in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>th
school,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">P</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>=</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><msub><mi>ùê±</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>,</mo><msub><mi>ùõà</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ŒΩ</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ŒΩ</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\text{P}(y_{ijk} = 1 | \mathbf{x}_{ijk}, \boldsymbol{\eta}_{jk}) = \frac{\exp(\nu_{ijk})}{1 + \exp(\nu_{ijk})}
</annotation></semantics></math></p>
<p>The latent variable vector is given by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùõà</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œ∑</mi><mi>j</mi></msub><mo>,</mo><msub><mi>Œ∑</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{\eta}_{jk} = (\eta_{j}, \eta_{jk})^{T}</annotation></semantics></math>,
where the last element is the effect of the school which the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>th
student attends. The nonlinear predictor is given by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ŒΩ</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>=</mo><msubsup><mi>ùê±</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow><mi>T</mi></msubsup><mi>ùõÉ</mi><mo>+</mo><msubsup><mi>ùê±</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow><mi>T</mi></msubsup><mi>ùõå</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œ∑</mi><mi>j</mi></msub><mo>+</mo><msub><mi>Œ∑</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\nu_{ijk} = \mathbf{x}_{ijk}^{T} \boldsymbol{\beta} + \mathbf{x}_{ijk}^{T}\boldsymbol{\lambda} (\eta_{j} + \eta_{jk})
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùê±</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf{x}_{ij}</annotation></semantics></math>
is a vector containing dummy variables for items,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ∑</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\eta_{j}</annotation></semantics></math>
is a latent variable describing the underlying ability of student
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ∑</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\eta_{k}</annotation></semantics></math>
is a latent variable describing the effect of school
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.
The factor loading
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
describes how the sum of the two latent variables impacts the nonlinear
predictor, and hence the probability of correct response. We note that
using a common
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
for two latent variables like this is not necessarily a good model, but
it makes this introductory example easier to follow. We will extend the
model later.</p>
<p>The structural model is simply</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùõà</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub><mo>=</mo><msub><mi>ùõá</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub><mo>‚àº</mo><msub><mi>N</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>ùüé</mn><mo>,</mo><mi>ùöø</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\boldsymbol{\eta}_{jk} = \boldsymbol{\zeta}_{jk} \sim N_{2}(\mathbf{0}, \boldsymbol{\Psi}),
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>ùüé</mn><mo>,</mo><mi>ùöø</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N(\mathbf{0}, \boldsymbol{\Psi})</annotation></semantics></math>
denotes a bivariate normal distribution with mean zero covariance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùöø</mi><annotation encoding="application/x-tex">\boldsymbol{\Psi}</annotation></semantics></math>.
The covariance matrix is assumed to be diagonal.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IRTsim</span><span class="op">$</span><span class="va">item</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">IRTsim</span><span class="op">$</span><span class="va">item</span><span class="op">)</span></span></code></pre></div>
<p>We confirm that <code>item</code> has five levels. This means that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõå</mi><annotation encoding="application/x-tex">\boldsymbol{\lambda}</annotation></semantics></math>
is a vector with five elements.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">IRTsim</span><span class="op">$</span><span class="va">item</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   1   2   3   4   5 </span></span>
<span><span class="co">#&gt; 500 500 500 500 500</span></span></code></pre></div>
<p>For identifiability, we fix the first element of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõå</mi><annotation encoding="application/x-tex">\boldsymbol{\lambda}</annotation></semantics></math>
to one. The rest will be freely estimated. We do this by defining the
following matrix. Any numeric value implies that the element is fixed,
whereas <code>NA</code> implies that the element is unknown, and will be
estimated.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">loading_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1]</span></span>
<span><span class="co">#&gt; [1,]    1</span></span>
<span><span class="co">#&gt; [2,]   NA</span></span>
<span><span class="co">#&gt; [3,]   NA</span></span>
<span><span class="co">#&gt; [4,]   NA</span></span>
<span><span class="co">#&gt; [5,]   NA</span></span></code></pre></div>
<p>We fit the model as follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/galamm.html">galamm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">item</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">ability</span> <span class="op">|</span> <span class="va">school</span> <span class="op">/</span> <span class="va">sid</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">IRTsim</span>,</span>
<span>  family <span class="op">=</span> <span class="va">binomial</span>,</span>
<span>  load_var <span class="op">=</span> <span class="st">"item"</span>,</span>
<span>  factor <span class="op">=</span> <span class="st">"ability"</span>,</span>
<span>  lambda <span class="op">=</span> <span class="va">loading_matrix</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>A couple of things in the model formula are worth pointing out. First
the part <code>(0 + ability | school / sid)</code> in the model formula
specifies that student ability varies between students within schools.
It corresponds to the term
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>ùê±</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow><mi>T</mi></msubsup><mi>ùõå</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œ∑</mi><mi>j</mi></msub><mo>+</mo><msub><mi>Œ∑</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{x}_{ijk}^{T}\boldsymbol{\lambda} (\eta_{j} + \eta_{jk})</annotation></semantics></math>
in the mathematical specification of the model. The variable
<code>ability</code> is not part of the <code>IRTsim</code> dataframe,
but is instead specified in the argument
<code>factor = "ability"</code>. The argument
<code>load_var = "item"</code> specifies that all rows in the dataframe
with the same value of ‚Äúitem‚Äù should get the same element of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõå</mi><annotation encoding="application/x-tex">\boldsymbol{\lambda}</annotation></semantics></math>,
and hence it defines the dummy variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùê±</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf{x}_{ijk}</annotation></semantics></math>.
Finally, <code>lambda = loading_matrix</code> provides the matrix of
factor loadings. Note that we must explicitly add a zero in
<code>(0 + ability | school / sid)</code> to avoid having a random
intercept estimated in addition to the effect for each value of ‚Äúitem‚Äù;
such a model would not be identified. The fixed effect part of the model
formula, which is simply <code>item</code>, specifies the term
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>ùê±</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow><mi>T</mi></msubsup><mi>ùõÉ</mi></mrow><annotation encoding="application/x-tex">\mathbf{x}_{ijk}^{T} \boldsymbol{\beta}</annotation></semantics></math>.</p>
<p>We can start by inspecting the fitted model:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; GALAMM fit by maximum marginal likelihood.</span></span>
<span><span class="co">#&gt; Formula: y ~ item + (0 + ability | school/sid)</span></span>
<span><span class="co">#&gt;    Data: IRTsim</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;   2966.4   3030.5  -1472.2   2372.3     2489 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -2.8884 -0.7335  0.4266  0.6235  3.0410 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Lambda:</span></span>
<span><span class="co">#&gt;         ability     SE</span></span>
<span><span class="co">#&gt; lambda1  1.0000      .</span></span>
<span><span class="co">#&gt; lambda2  0.7370 0.1456</span></span>
<span><span class="co">#&gt; lambda3  0.9351 0.1872</span></span>
<span><span class="co">#&gt; lambda4  0.6069 0.1261</span></span>
<span><span class="co">#&gt; lambda5  0.5860 0.1163</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups     Name    Variance Std.Dev.</span></span>
<span><span class="co">#&gt;  sid:school ability 1.466    1.211   </span></span>
<span><span class="co">#&gt;  school     ability 1.300    1.140   </span></span>
<span><span class="co">#&gt; Number of obs: 2500, groups:  sid:school, 500; school, 26</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)   0.5112     0.2617   1.953 0.050777</span></span>
<span><span class="co">#&gt; item2         0.3256     0.1791   1.818 0.069068</span></span>
<span><span class="co">#&gt; item3        -0.4491     0.1623  -2.768 0.005644</span></span>
<span><span class="co">#&gt; item4         0.4930     0.1924   2.562 0.010402</span></span>
<span><span class="co">#&gt; item5         0.4585     0.1922   2.385 0.017067</span></span></code></pre></div>
<p>The <code>fixef</code> method lets us consider the fixed effects:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fixef.html">fixef</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; (Intercept)       item2       item3       item4       item5 </span></span>
<span><span class="co">#&gt;   0.5112006   0.3255941  -0.4491070   0.4929827   0.4584897</span></span></code></pre></div>
<p>We can also get Wald type confidence intervals for the fixed
effects.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">mod</span>, parm <span class="op">=</span> <span class="st">"beta"</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    2.5 %     97.5 %</span></span>
<span><span class="co">#&gt; (Intercept) -0.001727334  1.0241286</span></span>
<span><span class="co">#&gt; item2       -0.025430062  0.6766183</span></span>
<span><span class="co">#&gt; item3       -0.767138526 -0.1310755</span></span>
<span><span class="co">#&gt; item4        0.115869898  0.8700955</span></span>
<span><span class="co">#&gt; item5        0.081749228  0.8352303</span></span></code></pre></div>
<p>We can similarly extract the factor loadings.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/factor_loadings.galamm.html">factor_loadings</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt;           ability        SE</span></span>
<span><span class="co">#&gt; lambda1 1.0000000        NA</span></span>
<span><span class="co">#&gt; lambda2 0.7370254 0.1455782</span></span>
<span><span class="co">#&gt; lambda3 0.9351105 0.1872049</span></span>
<span><span class="co">#&gt; lambda4 0.6069065 0.1260943</span></span>
<span><span class="co">#&gt; lambda5 0.5859914 0.1162977</span></span></code></pre></div>
<p>And we can find confidence intervals for them. Currently, only Wald
type confidence intervals are available. Be aware that such intervals
may have poor coverage properties.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">mod</span>, parm <span class="op">=</span> <span class="st">"lambda"</span><span class="op">)</span></span>
<span><span class="co">#&gt;             2.5 %    97.5 %</span></span>
<span><span class="co">#&gt; lambda1 0.4516974 1.0223534</span></span>
<span><span class="co">#&gt; lambda2 0.5681956 1.3020254</span></span>
<span><span class="co">#&gt; lambda3 0.3597662 0.8540468</span></span>
<span><span class="co">#&gt; lambda4 0.3580520 0.8139307</span></span></code></pre></div>
<p>We can also make a diagnostic plot, where we use deviance residuals
since these are more useful for logistic regression models. The division
into two parts is a consequence of the binary outcomes.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, form <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">.</span>, type <span class="op">=</span> <span class="st">"deviance"</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, abline <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="glmm_factor_binomial_diagnostic-1.png" alt="Diagnostic plot for binomial model."><div class="figcaption">Diagnostic plot for binomial model.</div>
</div>
</div>
<div class="section level3">
<h3 id="binomial-model-with-multiple-trials">Binomial Model with Multiple Trials<a class="anchor" aria-label="anchor" href="#binomial-model-with-multiple-trials"></a>
</h3>
<p>We now show how the model studied above can be extended to handle
binomially distributed data with multiple trials. We simulate such data
by computing predictions from the model fitted above, and drawing
binomial samples with multiple trials.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">IRTsim</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">trials</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">trials</span>,</span>
<span>  prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt;     sid school item y trials</span></span>
<span><span class="co">#&gt; 1.1   1      1    1 8     10</span></span>
<span><span class="co">#&gt; 1.2   1      1    2 5      6</span></span>
<span><span class="co">#&gt; 1.3   1      1    3 5      5</span></span>
<span><span class="co">#&gt; 1.4   1      1    4 5      9</span></span>
<span><span class="co">#&gt; 1.5   1      1    5 3      5</span></span>
<span><span class="co">#&gt; 2.1   2      1    1 5      6</span></span></code></pre></div>
<p>For binomial models with more than one trial, the response should be
specified <code>cbind(successes, failures)</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">galamm_mod_trials</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/galamm.html">galamm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">trials</span> <span class="op">-</span> <span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="va">item</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">ability</span> <span class="op">|</span> <span class="va">school</span> <span class="op">/</span> <span class="va">sid</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>  family <span class="op">=</span> <span class="va">binomial</span>,</span>
<span>  load_var <span class="op">=</span> <span class="st">"item"</span>,</span>
<span>  factor <span class="op">=</span> <span class="st">"ability"</span>,</span>
<span>  lambda <span class="op">=</span> <span class="va">loading_matrix</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>All the utility functions apply to this model as well. We simply post
its summary output here.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">galamm_mod_trials</span><span class="op">)</span></span>
<span><span class="co">#&gt; GALAMM fit by maximum marginal likelihood.</span></span>
<span><span class="co">#&gt; Formula: cbind(y, trials - y) ~ item + (0 + ability | school/sid)</span></span>
<span><span class="co">#&gt;    Data: dat</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;   7149.8   7213.9  -3563.9   2974.8     2489 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -3.5305 -0.6906  0.0763  0.7734  2.1677 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Lambda:</span></span>
<span><span class="co">#&gt;         ability     SE</span></span>
<span><span class="co">#&gt; lambda1  1.0000      .</span></span>
<span><span class="co">#&gt; lambda2  0.7013 0.2123</span></span>
<span><span class="co">#&gt; lambda3  0.5007 0.1899</span></span>
<span><span class="co">#&gt; lambda4  0.4265 0.1869</span></span>
<span><span class="co">#&gt; lambda5  0.6326 0.2121</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups     Name    Variance Std.Dev.</span></span>
<span><span class="co">#&gt;  sid:school ability 0.00000  0.0000  </span></span>
<span><span class="co">#&gt;  school     ability 0.06048  0.2459  </span></span>
<span><span class="co">#&gt; Number of obs: 2500, groups:  sid:school, 500; school, 26</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error z value  Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)  0.57682    0.06436   8.962 3.191e-19</span></span>
<span><span class="co">#&gt; item2        0.07417    0.05930   1.251 2.110e-01</span></span>
<span><span class="co">#&gt; item3       -0.09932    0.06205  -1.601 1.095e-01</span></span>
<span><span class="co">#&gt; item4        0.07328    0.06469   1.133 2.573e-01</span></span>
<span><span class="co">#&gt; item5        0.19302    0.06098   3.165 1.548e-03</span></span></code></pre></div>
<p>In this case the plot of residuals versus fitted values looks much
better than in the binary case, since with more trials the values are
closer to normal.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">galamm_mod_trials</span>, </span>
<span>  form <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">.</span>, type <span class="op">=</span> <span class="st">"deviance"</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, </span>
<span>  abline <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="unnamed-chunk-15-1.png" alt="plot of chunk unnamed-chunk-15"><div class="figcaption">plot of chunk unnamed-chunk-15</div>
</div>
</div>
<div class="section level3">
<h3 id="model-with-poisson-distributed-responses">Model with Poisson Distributed Responses<a class="anchor" aria-label="anchor" href="#model-with-poisson-distributed-responses"></a>
</h3>
<p>To illustrate the model for counts, we consider an example from
Chapter 11.3 in <span class="citation">Skrondal and Rabe-Hesketh (<a href="#ref-skrondalGeneralizedLatentVariable2004">2004</a>)</span>. The
model does not contain factor loadings, but we use it to demonstrate how
to fit GLMMs with Poisson distributed responses.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/galamm.html">galamm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">lbas</span> <span class="op">*</span> <span class="va">treat</span> <span class="op">+</span> <span class="va">lage</span> <span class="op">+</span> <span class="va">v4</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">subj</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">epilep</span>,</span>
<span>  family <span class="op">=</span> <span class="va">poisson</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can look at the summary output.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">count_mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; GALAMM fit by maximum marginal likelihood.</span></span>
<span><span class="co">#&gt; Formula: y ~ lbas * treat + lage + v4 + (1 | subj)</span></span>
<span><span class="co">#&gt;    Data: epilep</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">#&gt;   1344.7   1369.0   -665.4    407.0      229 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -3.1918 -0.8456 -0.0917  0.5839  6.6303 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups Name        Variance Std.Dev.</span></span>
<span><span class="co">#&gt;  subj   (Intercept) 0.2516   0.5016  </span></span>
<span><span class="co">#&gt; Number of obs: 236, groups:  subj, 59</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error z value  Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)   1.7936    0.10468  17.134 8.230e-66</span></span>
<span><span class="co">#&gt; lbas          0.8845    0.13096   6.754 1.436e-11</span></span>
<span><span class="co">#&gt; treat        -0.3350    0.14775  -2.267 2.339e-02</span></span>
<span><span class="co">#&gt; lage          0.4846    0.34658   1.398 1.621e-01</span></span>
<span><span class="co">#&gt; v4           -0.1611    0.05458  -2.952 3.161e-03</span></span>
<span><span class="co">#&gt; lbas:treat    0.3384    0.20293   1.668 9.541e-02</span></span></code></pre></div>
<p>In this case there are no factor loadings to return:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/factor_loadings.galamm.html">factor_loadings</a></span><span class="op">(</span><span class="va">count_mod</span><span class="op">)</span></span></code></pre></div>
<p>We can again look at a diagnostic plot.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">count_mod</span>, form <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">.</span>, type <span class="op">=</span> <span class="st">"deviance"</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, abline <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="glmm_factor_poisson_diagnostic-1.png" alt="Diagnostic plot for Poisson model."><div class="figcaption">Diagnostic plot for Poisson model.</div>
</div>
<p>We can also plot the residuals per subject:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">count_mod</span>, form <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid</a></span><span class="op">(</span><span class="va">.</span>, type <span class="op">=</span> <span class="st">"deviance"</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">subj</span><span class="op">)</span>, </span>
<span>     abline <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="unnamed-chunk-19-1.png" alt="plot of chunk unnamed-chunk-19"><div class="figcaption">plot of chunk unnamed-chunk-19</div>
</div>
<p>In this case we can confirm that the <code>galamm</code> function is
correctly implemented by comparing it to the output of
<code><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">lme4::glmer</a></code>. For a model like this, it would also be best
to use <code>lme4</code>, but with factor structures or other
nonlinearities, <code>lme4</code> no longer provides the flexibility we
need.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span><span class="va">count_mod_lme4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">lbas</span> <span class="op">*</span> <span class="va">treat</span> <span class="op">+</span> <span class="va">lage</span> <span class="op">+</span> <span class="va">v4</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">subj</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">epilep</span>,</span>
<span>  family <span class="op">=</span> <span class="va">poisson</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can confirm that the diagnostic plot has the same values as for
galamm:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">count_mod_lme4</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="glmm_factor_poisson_diagnostic_lme4-1.png" alt="lme4 diagnostic plot for Poisson model."><div class="figcaption">lme4 diagnostic plot for Poisson model.</div>
</div>
<p>And we can do the same for the summary output.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">count_mod_lme4</span><span class="op">)</span></span>
<span><span class="co">#&gt; Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) ['glmerMod']</span></span>
<span><span class="co">#&gt;  Family: poisson  ( log )</span></span>
<span><span class="co">#&gt; Formula: y ~ lbas * treat + lage + v4 + (1 | subj)</span></span>
<span><span class="co">#&gt;    Data: epilep</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       AIC       BIC    logLik -2*log(L)  df.resid </span></span>
<span><span class="co">#&gt;    1344.7    1369.0    -665.4    1330.7       229 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -3.1918 -0.8456 -0.0918  0.5837  6.6303 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups Name        Variance Std.Dev.</span></span>
<span><span class="co">#&gt;  subj   (Intercept) 0.2515   0.5015  </span></span>
<span><span class="co">#&gt; Number of obs: 236, groups:  subj, 59</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)   1.7937     0.1045  17.165  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; lbas          0.8844     0.1308   6.764 1.34e-11 ***</span></span>
<span><span class="co">#&gt; treat        -0.3349     0.1474  -2.272  0.02311 *  </span></span>
<span><span class="co">#&gt; lage          0.4845     0.3458   1.401  0.16122    </span></span>
<span><span class="co">#&gt; v4           -0.1611     0.0543  -2.966  0.00301 ** </span></span>
<span><span class="co">#&gt; lbas:treat    0.3382     0.2025   1.671  0.09479 .  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span><span class="co">#&gt;            (Intr) lbas   treat  lage   v4    </span></span>
<span><span class="co">#&gt; lbas       -0.035                            </span></span>
<span><span class="co">#&gt; treat      -0.708  0.024                     </span></span>
<span><span class="co">#&gt; lage       -0.092 -0.037  0.099              </span></span>
<span><span class="co">#&gt; v4          0.015  0.000  0.000  0.000       </span></span>
<span><span class="co">#&gt; lbas:treat  0.001 -0.654 -0.087  0.252  0.000</span></span></code></pre></div>
<p>You might note that the deviance in the summary output of the model
fitted by lme4 is different from the deviance of the model fitted by
galamm. This is because in the summary output, lme4 shows the deviance
as minus two times the log likelihood. In contrast, calling the deviance
function on a model object fitted by glmer gives the same output as
galamm.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></span><span class="op">(</span><span class="va">count_mod_lme4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 407.0092</span></span></code></pre></div>
<p>For details on deviance calculation in lme4, see
<code><a href="https://rdrr.io/pkg/lme4/man/merMod-class.html" class="external-link">help(deviance.merMod, "lme4")</a></code>.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-jeonProfileLikelihoodApproachEstimating2012" class="csl-entry">
Jeon, Minjeong, and Sophia Rabe-Hesketh. 2012.
<span>‚ÄúProfile-<span>Likelihood Approach</span> for <span>Estimating
Generalized Linear Mixed Models With Factor Structures</span>.‚Äù</span>
<em>Journal of Educational and Behavioral Statistics</em> 37 (4):
518‚Äì42. <a href="https://doi.org/10.3102/1076998611417628" class="external-link">https://doi.org/10.3102/1076998611417628</a>.
</div>
<div id="ref-rabe-heskethGeneralizedMultilevelStructural2004" class="csl-entry">
Rabe-Hesketh, Sophia, Anders Skrondal, and Andrew Pickles. 2004.
<span>‚ÄúGeneralized Multilevel Structural Equation Modeling.‚Äù</span>
<em>Psychometrika</em> 69 (2): 167‚Äì90. <a href="https://doi.org/10.1007/BF02295939" class="external-link">https://doi.org/10.1007/BF02295939</a>.
</div>
<div id="ref-rockwoodEstimatingComplexMeasurement2019" class="csl-entry">
Rockwood, Nicholas J., and Minjeong Jeon. 2019. <span>‚ÄúEstimating
<span>Complex Measurement</span> and <span>Growth Models Using</span>
the <span>R Package PLmixed</span>.‚Äù</span> <em>Multivariate Behavioral
Research</em> 54 (2): 288‚Äì306. <a href="https://doi.org/10.1080/00273171.2018.1516541" class="external-link">https://doi.org/10.1080/00273171.2018.1516541</a>.
</div>
<div id="ref-skrondalGeneralizedLatentVariable2004" class="csl-entry">
Skrondal, Anders, and Sophia Rabe-Hesketh. 2004. <em>Generalized Latent
Variable Modeling</em>. Interdisciplinary <span>Statistics
Series</span>. Boca Raton, Florida: <span>Chapman and Hall/CRC</span>.
</div>
<div id="ref-sorensenLongitudinalModelingAgeDependent2023" class="csl-entry">
S√∏rensen, √òystein, Anders M. Fjell, and Kristine B. Walhovd. 2023.
<span>‚ÄúLongitudinal <span>Modeling</span> of <span>Age-Dependent Latent
Traits</span> with <span>Generalized Additive Latent</span> and
<span>Mixed Models</span>.‚Äù</span> <em>Psychometrika</em> 88 (2):
456‚Äì86. <a href="https://doi.org/10.1007/s11336-023-09910-z" class="external-link">https://doi.org/10.1007/s11336-023-09910-z</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by √òystein S√∏rensen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
